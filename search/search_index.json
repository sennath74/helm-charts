{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome","text":"<p>This is the documentation for using Helm to deploy the Ping Identity Docker Images. This single chart can be used to deploy any of the available Ping Identity products in a Kubernetes environment.</p>"},{"location":"#devops-resources","title":"DevOps Resources","text":"Ping DevOps Docker Images Github Repos Community"},{"location":"#prerequisites","title":"Prerequisites","text":"<ul> <li>Kubernetes 1.16+</li> <li>Helm 3</li> <li>Ping Identity DevOps User/Key</li> </ul>"},{"location":"#adding-the-helm-repo","title":"Adding the Helm Repo","text":"<pre><code>helm repo add pingidentity https://helm.pingidentity.com/\n</code></pre>"},{"location":"#removing-the-repo","title":"Removing the Repo","text":"<pre><code>helm repo rm pingidentity\n</code></pre>"},{"location":"getting-started/","title":"Getting Started","text":"<p>Helm is a package deployment tool for Kubernetes. It can be used with PingDevops to deploy all the components of the Solution with a simple command.</p>"},{"location":"getting-started/#pre-requisites","title":"Pre-Requisites","text":"<ul> <li>Kubernetes Cluster</li> <li>Helm 3</li> <li>Ping Identity DevOps User/Key</li> </ul> <p>Openshift support</p> <p>Ping Helm charts support Openshift.  To see how to configure the values.yaml file to do so, see this page</p>"},{"location":"getting-started/#create-ping-devops-secret","title":"Create Ping DevOps Secret","text":"<p>The charts use a secret called <code>devops-secret</code> to obtain an evaluation license for running images.</p> <ul> <li>Eval License - Use your <code>PING_IDENTITY_DEVOPS_USER/PING_IDENTITY_DEVOPS_KEY</code> credentials   along with your <code>PING_IDENTITY_ACCEPT_EULA</code> setting.</li> <li>For more information on obtaining credentials click here.</li> <li>For more information on using <code>pingctl</code> utility click here.<pre><code>pingctl k8s generate devops-secret | kubectl apply -f -\n</code></pre> </li> </ul>"},{"location":"getting-started/#install-helm-3","title":"Install Helm 3","text":"<p>Ensure that you have Helm 3 installed.</p> <ul> <li>Installing on MacOS (or linux with brew)</li> </ul> <pre><code>brew install helm\n</code></pre> <ul> <li>Installing on other OS - https://helm.sh/docs/intro/install/</li> </ul>"},{"location":"getting-started/#add-helm-ping-devops-repo","title":"Add Helm Ping DevOps Repo","text":"<pre><code>helm repo add pingidentity https://helm.pingidentity.com/\n</code></pre>"},{"location":"getting-started/#list-ping-devops-charts","title":"List Ping DevOps Charts","text":"<pre><code>helm search repo pingidentity\n</code></pre>"},{"location":"getting-started/#update-local-machine-with-latest-charts","title":"Update local machine with latest charts","text":"<pre><code>helm repo update\n</code></pre>"},{"location":"getting-started/#install-the-ping-devops-chart","title":"Install the Ping DevOps Chart","text":"<p>Install the <code>ping-devops</code> chart using the example below.  In this case, it is installing a release called <code>pf</code>:</p> <ul> <li>PingFederate Admin instance</li> <li>PingFederate Engine instance</li> </ul> <pre><code>helm install pf pingidentity/ping-devops \\\n--set pingfederate-admin.enabled=true \\\n--set pingfederate-engine.enabled=true\n</code></pre> <p>or, if you have a <code>ping-devops-values.yaml</code>:</p> <pre><code># ping-devops-values.yaml\npingfederate-admin:\nenabled: true\n\npingfederate-engine:\nenabled: true\n</code></pre> <pre><code>helm install pf pingidentity/ping-devops \\\n-f ping-devops-values.yaml\n</code></pre>"},{"location":"getting-started/#accessing-deployments","title":"Accessing Deployments","text":"<p>Components of the release will be prefixed with <code>pf</code>.  Use <code>kubectl</code> to see the pods created.</p> <p>View kubernetes resources installed:</p> <pre><code># get just pods\nkubectl get pods --selector=app.kubernetes.io/instance=pf\n\n# or get even more\nkubectl get all --selector=app.kubernetes.io/instance=pf\n</code></pre> <p>View Logs (from deployment):</p> <pre><code>kubectl logs deployment/pf-pingfederate-admin\n</code></pre>"},{"location":"getting-started/#uninstalling-release","title":"Uninstalling Release","text":"<p>To uninstall a release from helm, use the following <code>helm uninstall</code> command:</p> <pre><code>helm uninstall pf\n</code></pre>"},{"location":"config/","title":"Introduction","text":"<p>The charts make heavy use of <code>Values</code> yaml files to pass configuration details to the Helm Charts.  As defined by Helm Values Files, values are provided to the chart using the following mechanisms:</p> <ul> <li><code>values.yaml</code> file in the chart</li> <li>Value files passed to Helm during install/upgrade with the <code>-f</code> flag</li> <li>Individual parameters pass with the <code>--set</code> flag</li> </ul> <p>The list above is in order of specificity: <code>values.yaml</code> in the chart can be overridden with <code>-f</code> supplied files, which can in turn be overridden with the <code>--set</code> parameter.</p> <p>The example below shows how values from the chart, user supplied <code>myconfig.yaml</code> and <code>--set</code> parameters are merged with each other to form a merged values.</p> <p></p>"},{"location":"config/#chart-values","title":"Chart Values","text":"<p>To see the values supplied by the chart, simply use the <code>helm show values</code> command to print them.  This provides both the data as well as context sensitive comments to each section.</p> <pre><code>helm show values pingidentity/ping-devops\n############################################################\n# Ping Identity DevOps values.yaml\n############################################################\n# ...\n</code></pre> <p>You can also see all the available values via this values.yaml link</p> <p>The default values are broken up into 2 major sections:</p> <ul> <li>global - Represents the base set of values that will be provided to each product section unless it's overridden in that section.</li> <li>product - For every image/product, the values will merged with the global settings, and take precedence.</li> </ul> <p>Warning</p> <p>Values can only be modified when merged.  They cannot be deleted.  Also, if a value is set to the boolean true, and merged with a boolean of false, it will always be true.</p>"},{"location":"config/#global-section","title":"global Section","text":"<p>The <code>global:</code> section of the values contains configuration that is available to each products section.  If a value is set in globals, that will be available to every product. This is very powerful, as you can turn on the ingress for every product by simply setting:</p> <pre><code>global:\ningress:\nenabled: true\n</code></pre> <p>This would in essence set <code>ingress.enabled=true</code> for every product:</p> <p><pre><code>pingaccess:\ningress:\nenabled: true\n\npingdirectory:\ningress:\nenable: true\n</code></pre> and so on.</p> <p>It is much easier to set something in the <code>global:</code> section, rather than repeat it for each product. To enable the ingress for only a few specific products, leave the default of <code>global.ingress.enabled=false</code> and set that value for those product sections.</p>"},{"location":"config/#product-sections","title":"Product Sections","text":"<p>Just like the <code>global:</code> values, each product can have the same values as well as many more that are specific to that product/image.  In the following example, persistent volume configuration is provided for PingDirectory:</p> <pre><code>pingdirectory:\npersistentvolume:\nenabled: true\nvolumes:\n- name: out-dir\nmountPath: /opt/out\nstorage: 8Gi\nstorageClassName:\n</code></pre>"},{"location":"config/container/","title":"Container Configuration","text":"<p>Kubernetes Workload Controller resources:</p> <ul> <li>Deployments</li> <li>StatefulSets</li> </ul> <p>are created depending on configuration values.</p>"},{"location":"config/container/#global-section","title":"Global Section","text":"<p>Default yaml defined in the global container section:</p> <pre><code>global:\ncontainer:\nreplicaCount: 1\nresources:\nrequests:\ncpu: 0\nmemory: 0\nlimits:\ncpu: 0\nmemory: 0\nnodeSelector: {}\ntolerations: []\naffinity: {}\nterminationGracePeriodSeconds: 30\nenvFrom: []\nlifecyle: {}\nprobes:\nlivenessProbe:\nexec:\ncommand:\n- /opt/liveness.sh\ninitialDelaySeconds: 30\nperiodSeconds: 30\ntimeoutSeconds: 5\nsuccessThreshold: 1\nfailureThreshold: 4\nreadinessProbe:\nexec:\ncommand:\n- /opt/readiness.sh\ninitialDelaySeconds: 30\nperiodSeconds: 5\ntimeoutSeconds: 5\nsuccessThreshold: 1\nfailureThreshold: 4\nstartupProbe:\nexec:\ncommand:\n- /opt/liveness.sh\nperiodSeconds: 10\ntimeoutSeconds: 5\nfailureThreshold: 90\n</code></pre>"},{"location":"config/container/#probes-configuration","title":"Probes Configuration","text":"<p>Kubernetes Probes defined in the <code>container:</code> section will be added to workloads (i.e. Deployments/StatefulSets).</p> <p>Fields used to configure probes can be found here.</p>"},{"location":"config/external-image/","title":"External Image Configuration","text":"<p>Defines an external image for initContainer utilities.</p>"},{"location":"config/external-image/#global-section","title":"Global Section","text":"<p>Default yaml defined in the global externalImage section:</p> <pre><code>global:\nexternalImage:\npingtoolkit: pingidentity/pingtoolkit:latest\n</code></pre> External Image Parameters Description pingtoolkit Registry, image and tag location for pingtoolkit.  Used for primarily during init containers. <p>Private Repository Location</p> <p>If your kubernetes cluster doesn't have access to an external docker repository, you can download and save the <code>pingtoolkit</code> image to your local repo.  Setting this to your local repo will cause the charts to use that image.</p>"},{"location":"config/global/","title":"global: values","text":"<p>There is a top level global value providing instructions on how to name all kubernetes resources, so a deployer might deploy several releases under the same namespace.</p>"},{"location":"config/global/#addreleasenametoresource","title":"addReleaseNameToResource","text":"<p>Provides global ability to add the Helm <code>.Release.Name</code> to kubernetes resources.</p> Value Description Example: (Release.Name=acme, resource=pingdirectory) prepend Prepends the Release.Name DEFAULT acme-pingdirectory append Appends the Release.Name pingdirectory-acme none No use of Release.Name pingdirectory"},{"location":"config/image/","title":"Image Configuration","text":"<p>Provides values to define kubernetes image information to deployments and statefulsets.</p>"},{"location":"config/image/#global-section","title":"Global Section","text":"<p>Default image yaml defined in the global section:</p> <pre><code>global:\nimage:\nrepository: pingidentity\nname:                                 # Set in product section\ntag: 2201\npullPolicy: Always\n</code></pre>"},{"location":"config/image/#product-section","title":"Product Section","text":"<p>Each product section specifies the name by default</p> <pre><code>pingaccess-admin:\nimage:\nname: pingaccess\n</code></pre> <p>To have images use a different repository and tag</p> <pre><code>global:\nimage:\ntag: edge\nrepository: my.company.docker-repo.com\n</code></pre> <p>This would result in pulling a pingaccess image: <code>my.company.docker-repo.com/pingaccess:edge</code></p>"},{"location":"config/ingress/","title":"Ingress Configuration","text":"<p>Kubernetes Ingress resources are created depending on configuration values.</p>"},{"location":"config/ingress/#global-section","title":"Global Section","text":"<p>Default yaml defined in the global ingress section, followed by definitions for each parameter:</p> <pre><code>global:\ningress:\nenabled: true\naddReleaseNameToHost: subdomain\ndefaultDomain: example.com\ndefaultTlsSecret:\nannotations: {}\n</code></pre> Ingress Parameters Description Options Default Value enabled Enables ingress definition. false addReleaseNameToHost How helm <code>release-name</code> should be added to host. prependappendsubdomainnone subdomain defaultDomain Default DNS domain to use.  Replaces the string \"_defaultDomain_\". example.com defaultTlsSecret Default TLS Secret to use.  Replaces the string \"_defaultTlsSecret_\". annotations Annotations are used to provide configuration details to specific ingress controller types. * see option for nginx ingress {} <p>Annotations example for nginx ingress</p> <pre><code>    annotations:\nnginx.ingress.kubernetes.io/backend-protocol: \"HTTPS\"\nkubernetes.io/ingress.class: \"nginx-public\"\n</code></pre>"},{"location":"config/ingress/#product-section","title":"Product Section","text":"<p>Default yaml defined in the product ingress section, followed by definitions for each parameter:</p> <pre><code>  ingress:\nhosts:\n- host: pingfederate-admin._defaultDomain_\npaths:\n- path: /\nbackend:\nserviceName: admin\ntls:\n- secretName: _defaultTlsSecret_\nhosts:\n</code></pre> Ingress Parameters Description Default Value hosts Array of hosts definitions hosts[].host Full DNS name of host to use for external name. \"_defaultDomain_\" will be replaced with .defaultDomain {product-name}._defaultDomain_ hosts[].paths Array of paths to define for host hosts[].paths[].path Path on external ingress hosts[].paths[].backend.serviceName Name of the service to map to.  This will result in the ingressPort on the server to be used. tls Array of tls definitions tls[].secretName Certificate secret to use _defaultTlsSecret_ tls[].hosts Array of specific hosts <p>Example Use of _defaultDomain_ and addReleaseNameToHost</p> <pre><code>    helm ReleaseName = acme\n        defaultDomain = example.com\n addReleaseNameToHost = subdomain\ningress.hosts[0].host = pingfed-admin._defaultDomain_\n\nResulting host will be:  pingfed-admin.acme.example.com\n                                         ^    ^^^^^^^\n                                         |       |\n                               ReleaseName    defaultDomain\n</code></pre>"},{"location":"config/ingress/#example-ingress-manifest","title":"Example Ingress Manifest","text":"<p>Example product ingress for pingfederate-admin when deployed by helm with a release-name of acme. Includes an ingress for admin service (9999) using the default domain and tls secret, defined in the global section, if set.</p> <pre><code>kind: Ingress\nmetadata:\nannotations:\n....\nspec:\nrules:\n- host: pingfederate-admin.acme.example.com\nhttp:\npaths:\n- backend:\nserviceName: acme-pingfederate-admin\nserviceName: admin\npath: /\ntls:\n- hosts:\n- pingfederate-admin.acme.example.com\nsecretName: \"\"\n</code></pre>"},{"location":"config/license/","title":"License Configuration","text":"<p>Provides a secret used for obtaining evaluation licenses for Ping Identity products.</p>"},{"location":"config/license/#global-section","title":"Global Section","text":"<p>Default yaml defined in the global license section, followed by definitions for each parameter:</p> <pre><code>global:\nlicense:\nsecret:\ndevOps: devops-secret\n</code></pre> License Parameters Description Default Value secret.devops Secret containing PING_IDENTITY_DEVOPS_USER/KEY values. devops-secret <p>Creating your devops-secret</p> <p>Use the pingctl command-line tool to create the <code>devops-secret</code> with your Ping Identity DevOps User &amp; Key.</p> <pre><code>pingctl kubernetes generate devops-secret | kubectl apply -f -\n</code></pre>"},{"location":"config/openshift/","title":"Openshift Configuration","text":"<p>Openshift is designed to use a randomly generated user ID and group ID (UID/GID) for the <code>runAsUser</code> and <code>fsGroup</code> fields of the Pod- and container-level security contexts.</p> <p>By default, the security contexts in the chart use values corresponding to the user and group IDs under which the product runs. You can unset the <code>fsGroup</code> and <code>runAsUser</code> securityContext fields in your custom values, allowing OpenShift to set them as expected.</p>"},{"location":"config/openshift/#unset-fsgroup-and-runasuser-at-the-pod-level","title":"Unset fsGroup and runAsUser at the Pod level","text":"<p>In the global section of the values.yaml file, add the following stanza:</p> <pre><code>global:\n  workload:\n    securityContext:\n      fsGroup: null\n      runAsUser: null\n</code></pre> <p>This will unset <code>fsGroup</code> and <code>runAsUser</code> in the Pod-level security context. Pods that require initContainers will have to also unset <code>runAsUser</code> in the container-level security context.</p>"},{"location":"config/openshift/#initcontainers-unset-runasuser-at-the-container-level","title":"initContainers: unset runAsUser at the container level","text":"<p>Some of the product deployments use initContainers for various operations, such as waiting for other services to be available or configuration actions.  These containers, while part of the workload, have the security context set at the container - not pod - level.  The values listed above apply only to the Pod-level security context.  To unset <code>runAsUser</code> for any pingtoolkit initContainers so Openshift can take over, also add the following stanza: <pre><code>global:\n  externalImage:\n    pingtoolkit:\n      securityContext:\n        runAsUser: null\n</code></pre></p> <p>For example, here is a complete block for configuring pingaccess-admin with a waitFor initContainer: <pre><code>global:\n  workload:\n    securityContext:\n      fsGroup: null\n      runAsUser: null\n  externalImage:\n    pingtoolkit:\n      securityContext:\n        runAsUser: null\n\npingaccess-admin:\n  enabled: true\nprivateCert:\n    generate: true\nenvs:\n    SERVER_PROFILE_URL: https://github.com/pingidentity/pingidentity-server-profiles.git\n    SERVER_PROFILE_PATH: baseline/pingaccess\n  container:\n    waitFor:\n      pingfederate-engine:\n        service: https\n        timeoutSeconds: 300\n</code></pre></p>"},{"location":"config/private-cert/","title":"PrivateCert Configuration","text":"<p>Generates a private certificate (.crt and .key) based on the internal hostname of the service.</p>"},{"location":"config/private-cert/#global-section","title":"Global Section","text":"<p>Default yaml defined in the global privateCert section.  By default certificates will not be generated.  It is advised to NOT generate internal certs at the global level, as many services don't need a private cert on the internal service.</p> <pre><code>global:\n############################################################\n# Internal Certificates\n#\n# If set to true, then an internal certificate secret will\n# be created along with mount of the certificate in\n# /run/secrets/internal-cert (creates a tls.crt and tls.key)\n#\n# By default the Issuer of the cert will be the service name\n# created by the Helm Chart.  Additionally, the ingress hosts,\n# if enabled, will be added to the list of X509v3 Subject Alternative Name\n#\n# Use the additionalHosts and additionalIPs if additional custom\n# names and ips are needed.\n#\n#      privateCert.generate: {true | false}\n#      privateCert.additionalHosts: {optional array of hosts}\n#      privateCert.additionalIPs: {optional array of IP Addresses}\n############################################################\nprivateCert:\ngenerate: false\nadditionalHosts: []\nadditioanlIPs: []\n</code></pre>"},{"location":"config/private-cert/#product-section","title":"Product Section","text":"<p>Generating an internal certificate is as simple setting the <code>privateCert.generate</code> to <code>true</code>.</p> <p>Example of generating an internal certificate for pingaccess-engine</p> <pre><code>pingaccess-admin:\nprivateCert:\ngenerate:true\n</code></pre> <p>This will ultimately create a secret named <code>{release-productname}-private-cert</code> containing a valid <code>tls.crt</code> and <code>tls.key</code>.</p> <p>By default the Issuer of the cert will be the service name created by the Helm Chart.  Additionally, the ingress hosts, if enabled, will be added to the list of <code>X509v3 Subject Alternative Name</code>.</p> <p>The product image will then create an init container to generate a pkcs12 file that will be placed in <code>/run/secrets/private-keystore/keystore.env</code> that will be mounted into the running container.</p> <p>When the container's hooks are running, it will source the environment variables in this keystore.env. The default variables set are:</p> <ul> <li><code>PRIVATE_KEYSTORE_PIN={base64 random pin}</code></li> <li><code>PRIVATE_KEYSTORE_TYPE=pkcs12</code></li> <li><code>PRIVATE_KEYSTORE={pkcs12 keystore}</code></li> </ul> <p>These environment variables can then be used in any server-profile artifacts to be replaced when the images are started.</p>"},{"location":"config/service/","title":"Service Configuration","text":"<p>Kubernetes Service resources are created depending on configuration values.</p>"},{"location":"config/service/#product-section","title":"Product Section","text":"<p>Default yaml defined in the product services section. The example found in the <code>pingfederate-admin</code> section is:</p> <pre><code>services:\nadmin:\nservicePort: 9999\ncontainerPort: 9999\ningressPort: 443\ndataService: true\nclusterbind:\nservicePort: 7600\ncontainerPort: 7600\nclusterService: true\nclusterfail:\nservicePort: 7700\ncontainerPort: 7700\nclusterService: true\nclusterExternalDNSHostname:\n</code></pre> Service Parameters Description services Array of services services[].{name} Service Name. (i.e. https, ldap, admin, api) services[].{name}.servicePort External port of service services[].{name}.containerPort Port on target container services[].{name}.ingressPort Port on ingress container (if ingress is used) services[].{name}.dataService Adds to a ClusterIP service with single DNS/IP services[].{name}.clusterService Adds to a headless service with DNS request returning all IPs services.clusterExternalDNSHostname <p>The example above will create a container/service/ingress that looks like:</p> <pre><code>  +-------------+               +-----------+              +-----------+\n  |  Container  |--(9999)-------|  Service  |-(9999)-------|  Ingress  |-(443)---\n  +-------------+               +-----------+              +-----------+\n\n\n  +-------------+  (7600)       +-----------+ (7600)\n  |  Container  |--(7700)-------|  Service  |-(7700)\n  +-------------+               +-----------+\n</code></pre>"},{"location":"config/supported-values/","title":"List of Supported Values","text":""},{"location":"config/supported-values/#supported-values","title":"Supported values","text":"<p>These are the values supported in the ping-devops chart. In general, values specified in the global section can be overridden for individual products. The product sections have many global fields overridden by default (workloads, services, etc.).</p>"},{"location":"config/supported-values/#global-values","title":"Global values","text":"Name Description Default <code>global.annotations</code> Annotations listed, will be added to the kubernetes resource <code>{}</code> <code>global.labels</code> Labels listed, will be added to all Kubernetes resources. <code>{}</code> <code>global.envs</code> Environment variables listed will be added to the global-env-vars configmap <code>{}</code> <code>global.addReleaseNameToResource</code> Provides global ability to add names to kubernetes resources. One of <code>{none, append, prepend}</code> <code>prepend</code> <code>global.ingress.enabled</code> <code>false</code> <code>global.ingress.addReleaseToHost</code> Add release to host. One of <code>{prepend, append, subdomain, none}</code> <code>subdomain</code> <code>global.ingress.defaultDomain</code> Replaces with \"defaultDomain\" in host fields <code>example.com</code> <code>global.ingress.defaultTlsSecret</code> Replaces with \"defaultTlsSecret\" in tls.secretName <code>global.ingress.annotations</code> <code>{}</code> <code>global.privateCert.generate</code> If true, then an internal certificate secret will be created along with mount of the certificate in /run/secrets/internal-cert (creates a tls.crt and tls.key). By default the Issuer of the cert will be the service name created by the Helm Chart. Additionally, the ingress hosts, if enabled, will be added to the list of X509v3 Subject Alternative Name <code>false</code> <code>global.privateCert.format</code> The format of the certificate to be generated. Used \"pingaccess-fips-pem\" to generate a valid certificate for running PingAccess in FIPS mode. Any other value will generate a PKCS12 keystore with the generated certificate. <code>PKCS12</code> <code>global.privateCert.additionalHosts</code> Additional hosts for the cert <code>[]</code> <code>global.privateCert.additionalIPs</code> Additional IP addresses for the cert <code>[]</code> <code>global.masterPassword</code> Uses Helm function derivePassword, which uses the master password specification: https://masterpassword.app/masterpassword-algorithm.pdf <code>global.masterPassword.enabled</code> Enable master password <code>false</code> <code>global.masterPassword.strength</code> Master password template. One of <code>{long, maximum}</code> <code>global.masterPassword.name</code> Defaults to release name <code>global.masterPassword.site</code> Defaults to chart name <code>global.masterPassword.secret</code> Defaults to release namespace <code>global.vault</code> Hashicorp Vault configuration <code>global.vault.enabled</code> Enable Vault <code>false</code> <code>global.vault.hashicorp.annotations</code> Annotation names, which will be appended to 'vault.hashicorp.com/' in the annotation. The vault.hashicorp.annotations.serviceAccountName value will be overwritten by the service account generated for the workload if there is one. <code>global.vault.secretPrefix</code> Prefix that will be prepended to any secrets being injected. <code>\"\"</code> <code>global.vault.secrets</code> Vault secrets to pull in <code>{}</code> <code>global.image.repository</code> Default image registry is not the fully-qualified name of the image Example: image.repository: pingidentity, docker.io, 123.dkr.ecr.us-west-1.amazonaws.com <code>pingidentity</code> <code>global.image.repositoryFqn</code> Docker image repository fully-qualified name. Overrides image.repository and image.name on the pod image spec Example: image.repositoryFqn: pingidentity/pingfederate, docker.io/my-pingfederate <code>global.image.name</code> Default image name MUST be set in child chart Example: image.name: pingfederate <code>global.image.tag</code> Default image tag <code>2303</code> <code>global.image.pullPolicy</code> Default image pull policy <code>IfNotPresent</code> <code>global.rbac.generateServiceAccount</code> Set to true to generate a service account for the workload. <code>false</code> <code>global.rbac.serviceAccountName</code> Name of the service account that will be generated. The default value of \"defaultServiceAccountName\" will result in a service account named based on the Helm installation and the specific workload being deployed. If generateServiceAccount and generateGlobalServiceAccount are false, this value can also refer to a service account created outside of Helm. <code>_defaultServiceAccountName_</code> <code>global.rbac.generateRoleAndRoleBinding</code> Set to true to generate a Role and RoleBinding corresponding to the workload service account. <code>false</code> <code>global.rbac.generateGlobalServiceAccount</code> Set to true to generate a service account for the entire installation. This global service account will be used for workloads that do not generate their own service account. <code>false</code> <code>global.rbac.generateGlobalRoleAndRoleBinding</code> Set to true to generate a Role and RoleBinding corresponding to the global service account for the entire installation. <code>false</code> <code>global.rbac.applyServiceAccountToWorkload</code> Set to true (the default) to apply to service account to the workload. <code>true</code> <code>global.rbac.role</code> This yaml will be directly inserted into the generated Role when generateRoleAndRoleBinding and/or generateGlobalRoleAndRoleBinding are true. The rules for the Role can be set here. <code>get, watch, and list verbs for the pods resource</code> <code>global.externalImage</code> Provides ability to use external images for various purposes such as using curl, waitfor, etc. A pingtoolkit image is included by default for running waitFor and generating private cert initContainers. A pingaccess image is also included by default to allow generating an encrypted PEM-formatted cert that is compatible with FIPS mode. Any values specified on the image will be copied directly to the k8s spec for the container, except for the externalImage.{name}.image section, which follows the format of the global.image section. If no image section is specified (the default), the corresponding value from the product values section will be used. For example, if externalImage.pingtoolkit.image is empty, the values from the top-level pingtoolkit.image section will be used. <code>{pingtoolkit, pingaccess}</code> <code>global.services</code> Services mapping a port to a targetPort on the corresponding container <code>{}</code> <code>global.services.clusterExternalDNSHostname</code> Value for the external-dns.alpha.kubernetes.io/hostname annotation for the cluster service. <code>global.services.clusterServiceName</code> If set, then this name will be used as the cluster service name (i.e clusterService == true). <code>global.services.useLoadBalancerForDataService</code> If true, the data service will be created with type: LoadBalancer. <code>false</code> <code>global.services.serviceName.dataService</code> If true, a ClusterIP service is created reachable within the cluster. A single IP is provided and the service will round-robin across the backend containers <code>global.services.serviceName.clusterService</code> If true, a headless service is created, explicitly specifying \"None\" for the clusterIP. DNS requests to this service will provide one of the IPs of the backend containers <code>global.services.serviceName.containerPort</code> Port on the kubernetes container <code>global.services.serviceName.servicePort</code> Port available from the kubernetes service. If clusterService=true this port on the cluster service is not really used, as the headless service always maps through to the container port <code>global.services.serviceName.ingressPort</code> Port available from the kubernetes ingress"},{"location":"config/supported-values/#workload-values-deployment-and-statefulset","title":"Workload values - Deployment and StatefulSet","text":"Name Description Default <code>global.workload</code> Can be Deployment or StatefulSet <code>Deployment</code> <code>global.workload.annotations</code> Workload annotations <code>global.workload.schedulerName</code> K8s scheduler <code>default-scheduler</code> <code>global.workload.shareProcessNamespace</code> Set shareProcessNamespace in the pod spec <code>false</code> <code>global.workload.enableServiceLinks</code> indicates whether info about services can be added as env variables <code>true</code> <code>global.workload.topologySpreadConstraints</code> Configuration of pod spread across cluster zones <code>[]</code> <code>global.workload.deployment</code> Deployment workload configuration <code>global.workload.deployment.strategy</code> Deployment pod replacement strategy <code>global.workload.deployment.strategy.type</code> Strategy type <code>RollingUpdate</code> <code>global.workload.deployment.strategy.rollingUpdate.maxSurge</code> Max surge, only applicable for RollingUpdate type <code>1</code> <code>global.workload.deployment.strategy.rollingUpdate.maxUnavailable</code> Max unavailable, only applicable for RollingUpdate type <code>0</code> <code>global.workload.statefulSet</code> StatefulSet workload configuration <code>global.workload.statefulSet.partition</code> Used for canary testing if n&gt;0 <code>0</code> <code>global.workload.statefulSet.persistentvolume.enabled</code> Enable persistent volumes <code>true</code> <code>global.workload.statefulSet.persistentvolume.volumes</code> For every volume defined in the volumes list, 3 items will be created in the StatefulSet: 1. container.volumeMounts - name and mountPath. 2. template.spec.volume - name and persistentVolumeClaim.claimName. 3. spec.volumeClaimTemplates - persistentVolumeClaim. <code>{out-dir}</code> <code>global.workload.statefulSet.persistentvolume.volumes.volumeName.mountPath</code> Mount path for the volume <code>global.workload.statefulSet.persistentvolume.volumes.volumeName.persistentVolumeClaim</code> volumeClaimTemplate <code>global.workload.statefulSet.podManagementPolicy</code> Controls how pods are created during initial scale up, when replacing pods on nodes, or when scaling down. The default behavior is OrderedReady. The Parallel podManagementPolicy allows for starting up and scaling down multiple Pods simultaneously. Updates are not affected. The only products that support Parallel are PingDirectory and PingDataSync, on versions 2209 and later. When using the Parallel policy, consider setting the RETRY_TIMEOUT_SECONDS environment variable to a higher value (it defaults to 180) for the Pods. If the value is too low with many servers starting at once, it may lead to some Pods restarting unnecessarily during the initial workload startup. <code>OrderedReady</code> <code>global.workload.securityContext</code> securityContext for the workload Pod spec. The securityContext defined will be inserted directly into the Pod spec. The user (9031) and group (0) represent the current user and group used with PingIdentity images (except PingDelegator). The fsGroup is required for any workloads that volumeMount a pvc (i.e. StatefulSets). Set as securityContext: null when no generated securityContext is desired. <code>fsGroup 0, runAsUser 9031, runAsGroup 0</code> <code>global.clustering.autoscaling</code> Configure Horizontal Pod Autoscaling <code>global.clustering.autoscaling.enabled</code> Enable Horizontal Pod Autoscaling. If enabled, ensure that proper container.resources values are set and coordinated with the targetCPUUtilizationPercentage or targetMemoryUtilizationPercentage <code>false</code> <code>global.clustering.autoscaling.minReplicas</code> Autoscaler minimum replicas <code>1</code> <code>global.clustering.autoscaling.maxReplicas</code> Autoscaler maximum replicas <code>4</code> <code>global.clustering.autoscaling.targetCPUUtilizationPercentage</code> Target CPU utilization <code>75</code> <code>global.clustering.autoscaling.targetMemoryUtilizationPercentage</code> Target memory utilization <code>global.clustering.autoscaling.behavior</code> Custom HPA behavior yaml <code>{}</code> <code>global.clustering.autoscalingMetricsTemplate</code> Custom HPA metrics yaml <code>[]</code> <code>global.container</code> Configure the container in the workload Pod spec <code>global.workload.container.securityContext</code> securityContext at the container level for the workload. The securityContext defined will be inserted directly into the spec for the main container of the Pod. By default no container securityContext is defined. In Kubernetes when a container-level securityContext is set, it will overwrite any corresponding values from the Pod-level securityContext. <code>null</code> <code>global.container.replicaCount</code> Number of replicas for workload <code>1</code> <code>global.container.resources</code> container resources yaml to insert into Pod spec <code>global.container.nodeSelector</code> nodeSelector yaml to insert into Pod spec <code>{}</code> <code>global.container.tolerations</code> tolerations yaml to insert into Pod spec <code>[]</code> <code>global.container.affinity</code> affinity yaml to insert into Pod spec <code>{}</code> <code>global.container.terminationGracePeriodSeconds</code> termination grace period <code>30</code> <code>global.container.envFrom</code> envFrom yaml to insert into Pod spec <code>[]</code> <code>global.container.env</code> Additional environment variables to insert into the Pod spec. Unlike the global.envs values, these will be set directly on the Pod. global.envs values are set in ConfigMaps rather than on the Pod directly. This value allows for setting the valueFrom field for an environment variable when necessary. <code>[]</code> <code>global.container.lifecycle</code> lifecycle yaml to insert into Pod spec <code>global.container.probes</code> probes yaml to insert into Pod spec <code>liveness, readiness, and startup probes defined</code>"},{"location":"config/supported-values/#other-global-defaults","title":"Other global defaults","text":"Name Description Default <code>global.license.secret.devOps</code> Identify the k8s secret containing the DevOps USER/KEY if used during deployment. pingctl can be used to generate the devops-secret <code>devops-secret</code> <code>global.utilitySidecar</code> Deploy a utility sidecar for running command-line tools. This sidecar is useful for command line utilities like collect-support-data. The sidecar will remain running alongside the workload, even when the sidecar isn't being used. It does not need to be listed in the includeSidecars value. <code>global.utilitySidecar.enabled</code> Enable the utility sidecar <code>false</code> <code>global.utilitySidecar.resources</code> Set k8s resources yaml for the sidecar spec <code>1 CPU and 2g memory limit, 0 CPU and 128Mi memory request</code> <code>global.includeSidecars</code> names of sidecars to include, from the top-level <code>sidecars</code> value <code>[]</code> <code>global.includeInitContainers</code> names of sidecars to include, from the top-level <code>initContainers</code> value <code>[]</code> <code>global.includeVolumes</code> names of sidecars to include, from the top-level <code>volumes</code> value <code>[]</code>"},{"location":"config/supported-values/#shared-utilities","title":"Shared utilities","text":"Name Description Default <code>sidecars</code> Sidecar yaml definitions available to product workload spec <code>{}</code> <code>initContainers</code> initContainer yaml definitions available to product workload spec <code>{}</code> <code>volumes</code> volume yaml definitions available to product workload spec for sidecars, initContainers, or main product containers <code>{}</code> <code>configMaps</code> configMap yaml definitions available to product workload spec for sidecars or main product containers <code>{}</code>"},{"location":"config/supported-values/#imageproduct-values","title":"Image/Product values","text":"Name Description Default <code>ldap-sdk-tools</code> LDAP SDK tools values <code>ldap-sdk-tools.enabled</code> Enable LDAP SDK tools deployment <code>false</code> <code>pingfederate-admin</code> PingFederate admin values <code>pingfederate-admin.enabled</code> Enable PingFederate admin deployment <code>false</code> <code>pingfederate-engine</code> PingFederate engine values <code>pingfederate-engine.enabled</code> Enable PingFederate engine deployment <code>false</code> <code>pingdirectory</code> PingDirectory values <code>pingdirectory.enabled</code> Enable PingDirectory deployment <code>false</code> <code>pingdirectory.cronjob</code> CronJobs run a kubectl exec command to run commands on a utility sidecar container. They will also create the necessary ServiceAccount, Role, and RoleBinding to run the jobs <code>pingdirectory.cronjob.enabled</code> Enable the PingDirectory CronJob <code>false</code> <code>pingdirectory.cronjob.spec</code> yaml to insert into the created CronJob spec. If a jobTemplate is not provided, a default template will be inserted. A schedule value must be provided <code>pingdirectory.cronjob.spec.jobTemplate</code> yaml to override default jobTemplate. <code>pingdirectory.cronjob.image</code> Image to run the Jobs. The image must include kubectl <code>bitname/kubectl:latest</code> <code>pingdirectory.cronjob.args</code> Job arguments <code>[]</code> <code>pingdirectory.services.serviceName.loadBalancerService</code> If true, the per-Pod LoadBalancer services enabled with pingdirectory.services.loadBalancerServicePerPod will include this port. <code>false</code> <code>pingdirectory.services.loadBalancerServicePerPod</code> Set to true to create a separate LoadBalancer service for each individual Pod in the PingDirectory StatefulSet. <code>false</code> <code>pingdirectory.services.loadBalancerExternalDNSHostnameSuffix</code> Value used for the external-dns.alpha.kubernetes.io/hostname annotation for the LoadBalancer services. This value will be used as a suffix for the hostname for each individual pod when pingdirectory.services.loadBalancerServicePerPod is set to true. <code>pingdirectoryproxy</code> PingDirectoryProxy values <code>pingdirectoryproxy.enabled</code> Enable PingDirectoryProxy deployment <code>false</code> <code>pingdelegator</code> PingDelegator values <code>pingdelegator.enabled</code> Enable PingDelegator deployment <code>false</code> <code>pingdatasync</code> PingDataSync values <code>pingdatasync.enabled</code> Enable PingDataSync deployment <code>false</code> <code>pingauthorize</code> PingAuthorize values <code>pingauthorize.enabled</code> Enable PingAuthorize deployment <code>false</code> <code>pingauthorizepap</code> PingAuthorizePAP values <code>pingauthorizepap.enabled</code> Enable PingAuthorizePAP deployment <code>false</code> <code>pingaccess-admin</code> PingAccess admin values <code>pingaccess-admin.enabled</code> Enable PingAccess admin deployment <code>false</code> <code>pingaccess-engine</code> PingAccess engine values <code>pingaccess-engine.enabled</code> Enable PingAccess engine deployment <code>false</code> <code>pingcentral</code> PingCentral values <code>pingcentral.enabled</code> Enable PingCentral deployment <code>false</code> <code>pingdataconsole</code> PingDataConsole values <code>pingdataconsole.enabled</code> Enable PingDataConsole deployment <code>false</code> <code>pingdataconsole.defaultLogin</code> Default login details for the console <code>pingdataconsole.defaultLogin.server.host</code> Default hostname <code>pingdirectory-cluster</code> <code>pingdataconsole.defaultLogin.server.port</code> Default port <code>636</code> <code>pingdataconsole.defaultLogin.username</code> Default username <code>administrator</code> <code>PingIntelligence</code> values <code>pingintelligence.enabled</code> Enable PingIntelligence deployment <code>false</code> <code>pd-replication-timing</code> PingDirectory replication timing values <code>pd-replication-timing.enabled</code> Enable PingDirectory replication timing deployment <code>false</code> <code>pingtoolkit</code> PingToolkit values <code>pingtoolkit.enabled</code> Enable PingToolkit deployment <code>false</code>"},{"location":"config/vault/","title":"Vault Configuration","text":"<p>The current helm chart support is provided for Hashicorp Vault annotations and use of the Hashicorp injector. More information on Hashicorp Vault annotations can be found here.</p>"},{"location":"config/vault/#vault-secret-values","title":"Vault Secret Values","text":"<p>An example vault values section looks like:</p> <pre><code>  vault:\n    enabled: true\n    hashicorp:\n      annotations:\n        role: {hashicorp-vault-role}\n      secretPrefix: {path to secret}\n      secrets:\n        {secret-name}:\n          {secret-key | to-json}:\n            path: /opt/in/some/location/secrets\n            file: devops-secret.env\n</code></pre> <p>The <code>vault.hashicorp.secrets</code> is a map that specifies each <code>secret</code> to pull from the vault.  And for each secret, a map specifies the <code>key</code> to pull with instructions of where to place the secret based on <code>path</code> and <code>file</code></p> License Parameters Description Default Value secrets.{secret} map of secret devops-secret secrets.{secret}.{key} map of key pingaccess.lic secrets.{secret}.{key}.path optional: location of secret. Defaults to vault.annotation.secret-volume-path /opt/in/some/path secrets.{secret}.{key}.file required: file name secrets placed into pingaccess.lic"},{"location":"config/vault/#special-key-name-to-json","title":"Special key name (<code>to-json</code>)","text":"<p>There is a special key name that can be provided that will drop the raw secret into the container as it's json representation with all the secret key names/values.</p> <p>If dropped into the <code>SECRETS_DIR</code> (defaults to <code>/run/secrets</code>) directory, these files will be processed as:</p> <ul> <li>PROPERTY_FILE if the file ends in <code>.env</code> or</li> <li>Separate files will be created for each key=value pair.</li> </ul> <p>See the example below in this document for the transformation that occurs with the <code>devops-secret.env</code>.</p>"},{"location":"config/vault/#vault-annotations","title":"Vault Annotations","text":"<p>Default yaml defined in the global vault section.  The options of annotation names/values can be found at vault definitions</p> <p>For each of the annotations, the helm chart will automatically pre-pend the annotation with the hashicorp annotation prefix of <code>vault.hashicorp.com</code>.  See example below.</p> <pre><code>global:\nvault:\nenabled: false\nhashicorp:\nannotations:\nagent-inject: true\nagent-init-first: true\nagent-pre-populate-only: true\nlog-level: info\npreserve-secret-case: true\nrole: k8s-default\nsecret-volume-path: /run/secrets\n</code></pre> <p>The serviceAccount used by Vault will match the default serviceAccount for the workload.</p>"},{"location":"config/vault/#example","title":"Example","text":"<p>The following includes an example Hashicorp Vault secrets as well as a value values .yaml that make use of the secrets and an example of where secrets will be placed into container.</p> <p>Example: Hashicorp Vault secrets</p> <p>SECRET:secrets/jsmith@example.com/jsmith-namespace/licenses</p> <pre><code>{\n  \"pingaccess-6.2\": \"Product=PingAccess\\nVersion=6.2...\",\n  \"pingdirectory-8.2\": \"Product=PingDirectory\\nVersion=8.2...\",\n  \"pingfederate-10.2\": \"Product=PingFederate\\nVersion=10.2...\"\n}\n</code></pre> <p>SECRET: secrets/jsmith@example.com/jsmith-namespace/devops-secrets.env <pre><code>{\n  \"PING_IDENTITY_ACCEPT_EULA\": \"YES\",\n  \"PING_IDENTITY_DEVOPS_KEY\": \"d254....-....-...-...-............\",\n  \"PING_IDENTITY_DEVOPS_USER\": \"jsmith@example.com\"\n}\n</code></pre></p> <p>SECRET: secrets/jsmith@example.com/jsmith-namespace/certs <pre><code>{\n  \"tls.crt\": \"LS0tLS1CRUdJ...a9dk\",\n  \"tls.key\": \"LS0tLS1CRUdJ...38sj\"\n}\n</code></pre></p> <p>Example: Vault secrets .yaml</p> <pre><code>pingfederate-admin:\nvault:\nhashicorp:\nsecrets:\ndevops-secret.env:\nto-json:\nfile: devops-secret.env\nlicenses:\npingaccess-6.2:\nfile: pingaccess.lic\npath: /opt/in/some/location/licenses\ntest-certs:\nto-json:\nfile: test-certs\n</code></pre> <p>Places the following files into the container:</p> <p>Example: Container files</p> <p>FILE: /run/secrets/devops-secret.env <pre><code>PING_IDENTITY_ACCEPT_EULA=\"YES\"\nPING_IDENTITY_DEVOPS_KEY=\"d254....-....-...-...-............\"\nPING_IDENTITY_DEVOPS_USER=\"jsmith@example.com\"\n</code></pre></p> <p>FILE: /opt/in/some/location/licenses/pingaccess.lic <pre><code>Product=PingAccess\nVersion=6.2\n...\n</code></pre></p> <p>FILE: /run/secrets/tls.crt <pre><code>LS0tLS1CRUdJ...a9dk\n</code></pre></p> <p>FILE: /run/secrets/tls.key <pre><code>LS0tLS1CRUdJ...38sj\n</code></pre></p>"},{"location":"config/vault/#using-vault-secrets-to-mount-base64-encoded-keystore-files","title":"Using Vault secrets to mount base64-encoded keystore files","text":"<p>To pull keystore files from a Vault cluster, create a secret with separate keys for each individual keystore file. The value of each key should be the base64 representation of the file that needs to be mounted. The names of the keys as well as the name of the secret will be used in the Helm values yaml when mounting the keystore files.</p> <p>Environment variables or other configuration for the product being deployed will need to be set to point to the location where the keystores are being mounted. For example, for PingDirectory:</p> <pre><code>KEYSTORE_FILE=/run/secrets/mykeystore.jks\nKEYSTORE_PIN_FILE=/run/secrets/mykeystore.pin\n</code></pre> <p>Ensure the Vault cluster is accessible to the Kubernetes cluster where your Helm release is being deployed. You can then use the Vault annotations to mount the keystore files in the desired location. For an example, see the \"Vault Keystores\" example on the Helm examples page.</p>"},{"location":"config/volume-mounts/","title":"VolumeMounts Configuration","text":"<p>Provides support for mounting secret or configMap volumes on a workload container.</p>"},{"location":"config/volume-mounts/#globalproduct-section","title":"Global/Product Section","text":"<p>Adds ability to use secret and configMap data in a container via a VolumeMount.  A common use for this - bringing product licenses or scripts into the container.</p> <p>Example of creating 2 volume mounts in container from secret and configMap</p> <pre><code>pingfederate-admin:\nenabled: true\nvolumes:\n- name: pf-props\nconfigMap:\nname: pingfederate-props\n- name: pf-license\nsecret:\nsecretName: pingfederate-license\nvolumeMounts:\n- mountPath: /opt/in/etc/pingfederate.properties\nname: pf-props\n- mountPath: /opt/in/instance/server/default/conf/pingfederate.lic\nname: pf-license\n</code></pre> <p>Secrets and ConfigMaps must be created in the cluster prior to deploying the helm chart.</p> <p>In this case, a secret (called pingfederate-license) and configMap (called pingfederate-props) will bring in a couple of key values (license, hello) and (pf-props) into the container as specific files. The results will looks like:</p> <p>Example of kubectl describe of pingfederate-admin container</p> <pre><code>Containers:\n  pingfederate-admin:\n    Mounts:\n      /opt/in/etc/pingfederate.properties from pingfederate-props (ro,path=\"pingfederate.properties\")\n      /opt/in/instance/server/default/conf/pingfederate.lic from pingfederate-license (ro,path=\"pingfederate.lic\")\nVolumes:\n  pingfederate-license:\n    Type:        Secret (a volume populated by a Secret)\n    SecretName:  pingfederate-license\n    Optional:    false\n  pingfederate-props:\n    Type:      ConfigMap (a volume populated by a ConfigMap)\n    Name:      pingfederate-props\n    Optional:  false\n</code></pre>"},{"location":"config/workload/","title":"Workload Configuration","text":"<p>Kubernetes Workload resources:</p> <ul> <li>Deployments</li> <li>StatefulSets</li> </ul> <p>are created depending on configuration values.</p>"},{"location":"config/workload/#global-section","title":"Global Section","text":"<p>Default yaml is defined in the global workload section. Individual products override these defaults based on the needed workload.</p> <pre><code>global:\nworkload:\ntype: Deployment\n\ndeployment:\nstrategy:\ntype: RollingUpdate\nrollingUpdate:\nmaxSurge: 1\nmaxUnavailable: 0\n\nstatefulSet:\npartition: 0\n\npersistentvolume:\nenabled: true\nvolumes:\nout-dir:\nmountPath: /opt/out\npersistentVolumeClaim:\naccessModes:\n- ReadWriteOnce\nstorageClassName:\nresources:\nrequests:\nstorage: 4Gi\n\nsecurityContext:\nfsGroup: 9999\nsecurityContext: {}\n</code></pre> Workload Parameters Description type One of Deployment or StatefulSet deployment.strategy.type One of RollingUpdate or ReCreate deployment.strategy.rollingUpdate If type=RollingUpdate statefulSet.partition Used for canary testing if n&gt;0 statefulSet.persistentVolume Provides details around creation of PVC/Volumes (see below) securityContext Provides security context details for starting container as different user/group (see below) securityContext.fsGroup Sets the group id on fileSystem writes.  This is needed especially for mounted volumes (pvs) <p>Persistent Volumes</p> <p>For every volume defined in the volumes list, 3 items will be created in the StatefulSet:</p> <ul> <li>container.volumeMounts - name and mountPath</li> <li>template.spec.volume - name and persistentVolumeClaim.claimName</li> <li>spec.volumeClaimTemplates - persistentVolumeClaim</li> </ul> <p>More Info - https://kubernetes.io/docs/concepts/storage/persistent-volumes/</p> <p>Security Context</p> <p>To run the containers with a different user/group/fsgroup, use the following example to set those details on the deployment/statefulset:</p> <pre><code>global:\nworkload:\ncontainer:\nsecurityContext:\nrunAsGroup: 9999\nrunAsUser: 9031\nfsGroup: 9999\n</code></pre> <p>WaitFor</p> <p>For each product, a <code>waitFor</code> structure providing the name, service and timeout, in seconds, that should be waited (defaults to 300 if not provided) on before the running container con continue.  This will inject an initContainer using the PingToolkit wait-for utility until it can <code>nc host:port</code> before continuing.</p> <p>Example: PingFederate Admin waiting on pingdirectory ldaps service to be available <pre><code>pingfederate-admin:\ncontainer:\nwaitFor:\npingdirectory:\nservice: ldaps\ntimeoutSeconds: 600\npingauthorize:\nservice: https\ntimeoutSeconds: 300\n</code></pre></p> <ul> <li>By default, the <code>pingfederate-engine</code> will waitFor <code>pingfederate-admin</code> before it starts.</li> <li>By default, the <code>pingaccess-engine</code> will waitFor <code>pingaccess-admin</code> before it starts.</li> </ul>"},{"location":"devops/","title":"Ping Identity Helm Charts","text":"<p>This repository provides sample Helm charts for Ping Identity products for community use.</p> <p>These helm charts are intended to be a good starting point and can be used and altered as required.</p>"},{"location":"devops/#charts","title":"Charts","text":"Chart Type Capability Status Scalable DevOps Full Application Includes all PingIdentity Charts Available (Beta) Yes PingFederate Product SSO / Authentication Authority Available (Beta) Yes PingAccess Product Medium/Course grain Authorization Gateway/PEP Available (Beta) No (TBC) PingDirectory Product User/Device/Consent/Organisation Directory Available (Beta) Yes PingDataConsole Product PingData Admin Console Available (Beta) Not required PingDataSync Product Data Synchronisation Engine Not available N/a PingDelegator Product Delegated User Management UI Not available Yes"},{"location":"examples/","title":"Helm Chart Examples","text":"<p>The example deployments of various configurations and combinations of Ping products with these charts are provided on the Ping Identity DevOps Portal.</p> <p>Configuration required</p> <p>Install and configure Helm according to the Getting Started page before trying the examples.</p>"},{"location":"howto/updatetags/","title":"Updating Product Image Tags","text":"<p>This page describes recommendations for updating products and image tags in a Helm installation. The focus is on what is needed to move from one docker image tag to another in the Helm chart, with some specific steps to follow for certain products. This page does not cover specifics on how to test upgrades or details on how to employ a blue-green update strategy. These processes will depend on the environment where the chart is deployed.</p> <p>Warning</p> <p>Always test upgrades in a non-production environment first.</p> <p>Before updating tags, be sure that you have exported any configuration from your servers and stored it in a server profile. This ensures no configuration is lost when pods are restarted. Information on how to save configuration into a server profile can be found in the How To section of the DevOps documentation.</p> <p>The upgrade process depends on the specific product within the Helm chart that is being upgraded.</p>"},{"location":"howto/updatetags/#blue-green-update","title":"Blue-green update","text":"<p>A simple way to handle version updates is via a blue-green deployment. In this strategy, a full second deployment of the workloads being updated is deployed on the new version, and then traffic is switched from the original deployment to the new one. When following this strategy, be sure that any necessary configuration is captured in a server profile, so that it is maintained in the fresh deployment.</p> <p>This strategy is particularly suited for stateless applications. Stateful applications like PingDirectory and PingDataSync would require further steps to ensure any data in the current deployment is maintained in the newer deployment.</p>"},{"location":"howto/updatetags/#in-place-update","title":"In-place update","text":"<p>Tags and product versions can also be updated in-place. The required process depends on the product being updated.</p>"},{"location":"howto/updatetags/#simple-tag-update","title":"Simple tag update","text":"<p>For some products, simply updating the tag is all that is needed. For example, updating from PingDirectory <code>8.3.0.5-latest</code> to PingDirectory <code>9.0.0.0-latest</code> can be done by updating the tag in values.yaml. <pre><code>pingdirectory:\n  enabled: true\n  image:\n    tag: 8.3.0.5-latest\n</code></pre> becomes</p> <p><pre><code>pingdirectory:\n  enabled: true\n  image:\n    tag: 9.0.0.0-latest\n</code></pre> The active Helm release can be updated after setting the new image tag.</p> <p><code>helm upgrade --install &lt;releasename&gt; pingidentity/ping-devops -f &lt;updated values.yaml&gt;</code></p> <p>Update logic will be automatically handled by hook scripts on container startup. This is true for PingDirectory, PingDirectoryProxy, PingDataSync, and PingAuthorize.</p> <p>For products that are not run as a StatefulSet, generally the tags can be updated without any additional update steps, after the server profile is updated and saved. If the server profile is not up to date with the configuration on the running pod(s), then configuration could be lost on a tag update.</p>"},{"location":"howto/updatetags/#product-updates-requiring-manual-steps","title":"Product updates requiring manual steps","text":"<p>Some products have more specific upgrade processes that needs to be followed when the product version is being updated, such as updating from PingFederate 10.3.7 to PingFederate 11.0.3.</p>"},{"location":"howto/updatetags/#pingfederate","title":"PingFederate","text":"<p>See the DevOps documentation instructions on upgrading PingFederate.</p> <p>By default pingfederate-admin and pingfederate-engine each run as Deployments in the chart. If you are running a maintenance upgrade (from PingFederate version x.x.1 to x.x.2 for example) it may be sufficient to export the configuration from the previous version and pull that same configuration via server profile when starting up the new version.</p> <p>Warning</p> <p>When upgrading a major or minor version, the upgrade steps at the above link should be followed.</p>"},{"location":"howto/updatetags/#pingaccess","title":"PingAccess","text":"<p>PingAccess will follow a similar process to the above instructions for PingFederate.</p> <p>By default pingaccess-admin runs as a StatefulSet in the chart, so the upgrade utility must be run to update the files in the persistent volume. Once the admin is updated, the engines (which run as Deployments by default) can be restarted with the new tag. See the PingAccess docs for more information.</p>"},{"location":"howto/updatetags/#pingauthorizepap","title":"PingAuthorizePAP","text":"<p>Ensure your policies are backed up along with your server profile before updating the tag.</p>"},{"location":"release-notes/currentRelease/","title":"Release Notes","text":""},{"location":"release-notes/currentRelease/#release-0912-april-03-2023","title":"Release 0.9.12 (April 03, 2023)","text":""},{"location":"release-notes/currentRelease/#features","title":"Features","text":"<ul> <li>Updated default global image tag to <code>2303</code>.</li> <li>Updated the workload <code>topologySpreadConstraints</code> field to automatically set <code>matchLabels</code> to match the workload labels.</li> </ul>"},{"location":"release-notes/previousReleases/","title":"Release Notes","text":""},{"location":"release-notes/previousReleases/#release-0911-march-03-2023","title":"Release 0.9.11 (March 03, 2023)","text":""},{"location":"release-notes/previousReleases/#features","title":"Features","text":"<ul> <li>Updated default global image tag to <code>2302</code>.</li> <li>Added default environment variables to <code>pingdirectoryproxy</code> to support joining a PingDirectory topology.</li> </ul>"},{"location":"release-notes/previousReleases/#release-0910-february-03-2023","title":"Release 0.9.10 (February 03, 2023)","text":""},{"location":"release-notes/previousReleases/#features_1","title":"Features","text":"<ul> <li>Updated default global image tag to <code>2301</code>.</li> <li>Updated the securityContext defaults for Pods and containers in the ping-devops Helm chart to satisfy the \"restricted\" Pod Security Standard in Kubernetes</li> <li>Added support for running a separate LoadBalancer service for each PingDirectory pod. This may be useful when running across multiple regions when using VPC peering isn't possible.</li> </ul>"},{"location":"release-notes/previousReleases/#resolved-defects","title":"Resolved Defects","text":"<ul> <li>Updated the HorizontalPodAutoscaler API to use the correct value for Kubernetes versions greater than 1.23.</li> </ul>"},{"location":"release-notes/previousReleases/#release-099-january-03-2023","title":"Release 0.9.9 (January 03, 2023)","text":""},{"location":"release-notes/previousReleases/#features_2","title":"Features","text":"<ul> <li>Updated default global image tag to <code>2212</code>.</li> <li>Removed <code>pingdatagovernance</code> and <code>pingdatagovernancepap</code> from the chart. Use <code>pingauthorize</code> and <code>pingauthorizepap</code> instead.</li> </ul>"},{"location":"release-notes/previousReleases/#release-098-december-05-2022","title":"Release 0.9.8 (December 05, 2022)","text":""},{"location":"release-notes/previousReleases/#features_3","title":"Features","text":"<ul> <li>Updated default global image tag to <code>2211</code>.</li> <li>Custom annotations can now be specified for Services.</li> </ul>"},{"location":"release-notes/previousReleases/#defects","title":"Defects","text":"<ul> <li>Fixed HorizontalPodAutoscaler autoscalingMetricsTemplate being inserted in the wrong location in the generated yaml.</li> <li>Fixed the documentation in values.yaml referring to <code>pingdirectory.cronjob.jobspec</code> rather than the correct value <code>pingdirectory.cronjob.jobTemplate</code></li> </ul>"},{"location":"release-notes/previousReleases/#release-097-november-02-2022","title":"Release 0.9.7 (November 02, 2022)","text":""},{"location":"release-notes/previousReleases/#features_4","title":"Features","text":"<ul> <li>Updated default global image tag to <code>2210</code>.</li> </ul>"},{"location":"release-notes/previousReleases/#release-096-october-04-2022","title":"Release 0.9.6 (October 04, 2022)","text":""},{"location":"release-notes/previousReleases/#features_5","title":"Features","text":"<ul> <li>Updated default global image tag to <code>2209</code>.</li> <li>Added support for deploying a HorizontalPodAutoscaler for pingaccess-engine, pingfederate-admin, pingdelegator, pingauthorize, pingauthorizepap, pingcentral, and pingdataconsole. Previously, deploying a HorizontalPodAutoscaler was only supported for pingfederate-engine.</li> <li>Added support for setting the podManagementPolicy for StatefulSet workloads. The default policy is OrderedReady. The Parallel policy allows for starting up multiple Pods of the StatefulSet simultaneously, improving initial deployment times. Parallel startup is only supported with PingDirectory and PingDataSync, and only with images version <code>2209</code> and newer.</li> </ul>"},{"location":"release-notes/previousReleases/#release-095-september-01-2022","title":"Release 0.9.5 (September 01, 2022)","text":""},{"location":"release-notes/previousReleases/#features_6","title":"Features","text":"<ul> <li>Updated default global image tag to <code>2208</code>.</li> <li>Added support for setting container-level securityContext values for the main container of each workload. By default no container-level securityContext will be set. A container-level securityContext isn't necessary if the values from the Pod-level securityContext are sufficient.</li> <li>Added support for setting the topologySpreadConstraints field on workloads.</li> <li>Added support for setting the enableServiceLinks field on workloads.</li> </ul>"},{"location":"release-notes/previousReleases/#documentation","title":"Documentation","text":"<ul> <li>Added an example for mounting keystore secrets with Vault</li> <li>Added an example for mounting secrets with CSI volumes (which can be used for various storage systems including AWS secrets manager)</li> <li>Fixed Helm RBAC example using an invalid serviceAccountName for pingauthorize</li> <li>Added a doc page describing how to update product versions</li> <li>Added example docs for deploying PingDirectory and PingFederate in a multi-region environment with Helm</li> </ul>"},{"location":"release-notes/previousReleases/#resolved-defects_1","title":"Resolved Defects","text":"<ul> <li>Removed support for apache-jmeter, since it is better suited to run as a Job than as a long-running workload.</li> </ul>"},{"location":"release-notes/previousReleases/#release-094-august-05-2022","title":"Release 0.9.4 (August 05, 2022)","text":""},{"location":"release-notes/previousReleases/#features_7","title":"Features","text":"<ul> <li>Updated default global image tag to <code>2207</code>.</li> <li>Added support for apache-jmeter</li> </ul>"},{"location":"release-notes/previousReleases/#resolved-defects_2","title":"Resolved Defects","text":"<ul> <li>Fixed an issue making it impossible to use an existing service account (an account not managed by the Helm chart) for a workload. An existing service account can now be used by specifying the <code>{product}.rbac.serviceAccountName</code> field while leaving <code>{product}.rbac.generateServiceAccount</code> set to the default <code>false</code> value. See the PingAuthorize section of the updated RBAC example</li> </ul>"},{"location":"release-notes/previousReleases/#release-093-july-01-2022","title":"Release 0.9.3 (July 01, 2022)","text":""},{"location":"release-notes/previousReleases/#features_8","title":"Features","text":"<ul> <li>Updated default global image tag to <code>2206</code>.</li> <li>Added support for PingIntelligence.</li> <li> <p>Updated the Helm chart to support generating ServiceAccounts, Roles, and RoleBindings for a workload. These can be generated globally (one common to each workload) or individually for each workload. By default none will be generated.</p> <p>These can be controlled with the global.rbac (or {product}.rbac) section. To generate a common ServiceAccount usable by all workloads, use global.rbac.generateGlobalServiceAccount. Use rbac.generateServiceAccount to generate separate ServiceAccounts for individual workloads. Similarly, use global.rbac.generateGlobalRoleAndRoleBinding and rbac.generateRoleAndRoleBinding for creating a Role and RoleBinding.</p> <p>Set rbac.applyServiceAccountToWorkload to true to set the account on the Deployment or StatefulSet. The name of the ServiceAccount will be autogenerated unless the rbac.serviceAccountName field is set. The specific Role yaml can be provided in rbac.role.</p> <p>The Vault default has changed. The Vault serviceAccount will now default to the autogenerated account for the workload, instead of the previous default of \"vault-auth\". This can be overriden by setting the vault.hashicorp.annotations.serviceAccountName value.</p> <p>See the table with sample Helm chart value files found on the Ping Identity Devops Portal for an example.</p> </li> <li> <p>Added a default empty global.labels section.</p> </li> </ul>"},{"location":"release-notes/previousReleases/#release-092-june-02-2022","title":"Release 0.9.2 (June 02, 2022)","text":""},{"location":"release-notes/previousReleases/#features_9","title":"Features","text":"<ul> <li>Updated default global image tag to <code>2205</code>.</li> <li>Added support for providing a null securityContext for a workload, which is useful for OpenShift security context constraints.</li> <li>Added support for enabling Ingress for pingdirectoryproxy and pingdatasync.</li> <li>Updated pingdirectoryproxy to be a StatefulSet by default in the Helm charts, with the persistent volume disabled. This supports having consistent proxy pod names.</li> <li>Added a new <code>privateCert.format</code> field, which can be set to <code>\"pingaccess-fips-pem\"</code> to generate a cert that can be used by PingAccess when running in FIPS mode. The cert is generated by a temporary PingAccess initContainer, as PingAccess requires a specific format for certs when in FIPS mode that must be generated from PingAccess itself. Leaving the field blank or setting it to any other value will generate a cert in the same manner as before - adding the key pair to a PKCS12 keystore file. </li> <li>Updated the externalImage values section to expect the same format for <code>image:</code> as the individual products (repository, image name, tag, etc. are provided separately). If no image values are specified for an externalImage, the corresponding defaults from the main product section will be used. For example, if <code>global.externalImage.pingtoolkit.image</code> is empty, then the values from the top-level <code>pingtoolkit.image</code> section will be used.</li> </ul>"},{"location":"release-notes/previousReleases/#release-091-may-05-2022","title":"Release 0.9.1 (May 05, 2022)","text":""},{"location":"release-notes/previousReleases/#features_10","title":"Features","text":"<ul> <li>Updated default global image tag to <code>2204</code></li> <li>Updated the PingDataSync env vars ConfigMap to include variables needed to enable failover between servers. Failover will be enabled when deploying two or more PingDataSync replicas</li> <li>Reduced utilitySidecar resource requests</li> </ul>"},{"location":"release-notes/previousReleases/#resolved-defects_3","title":"Resolved Defects","text":"<ul> <li>Updated the image.repositoryFqn field to be consistent with the other fields under image.     Previously, repositoryFqn was expected at the same level as the image: section, now it is expected within the image: section like other fields (tag, pullPolicy, etc.).     The image tag must now be provided separately from the repositoryFqn. The repositoryFqn should only be the name of the repository, not the tag of the specific image.</li> <li>Fixed a version check in the Helm chart for choosing the correct k8s API for Ingress. The version check was previously failing on EKS clusters due to the format EKS uses for the cluster version.</li> </ul>"},{"location":"release-notes/previousReleases/#release-090-april-01-2022","title":"Release 0.9.0 (April 01, 2022)","text":""},{"location":"release-notes/previousReleases/#features_11","title":"Features","text":"<ul> <li>Default global image tag updated to 2203</li> <li>Customizability on Cronjob and Utility Sidecar<ul> <li>Override jobTemplate in CronJob now available.</li> <li>Override image used in utilitySidecar now available.</li> </ul> </li> <li>Updated the default PingDataSync workload in the Ping devops Helm charts to use a StatefulSet rather than a Deployment. This ensures that the sync-state.ldif file is maintained between pod restarts.</li> </ul>"},{"location":"release-notes/previousReleases/#release-089-mar-17-2022","title":"Release 0.8.9 (Mar 17, 2022)","text":""},{"location":"release-notes/previousReleases/#features_12","title":"Features","text":"<ul> <li>Edit from 0.8.8 release. Previously the image fully qualified name also included the image tag, which was then duplicated upon deployment when \"tag\" value present.</li> </ul>"},{"location":"release-notes/previousReleases/#release-088-mar-16-2022","title":"Release 0.8.8 (Mar 16, 2022)","text":""},{"location":"release-notes/previousReleases/#features_13","title":"Features","text":"<ul> <li>Added support for fully qualified image location. For more information go to the image section in our values.yaml <pre><code>  image:\n    repository: pingidentity\n    repositoryFqn:\n    name:\n    tag: \"2202\"\n    pullPolicy: IfNotPresent\n</code></pre></li> </ul>"},{"location":"release-notes/previousReleases/#release-087-mar-11-2022","title":"Release 0.8.7 (Mar 11, 2022)","text":""},{"location":"release-notes/previousReleases/#features_14","title":"Features","text":"<ul> <li>Corrected Default global image tag updated to 2202</li> </ul>"},{"location":"release-notes/previousReleases/#release-086-mar-3-2022","title":"Release 0.8.6 (Mar 3, 2022)","text":""},{"location":"release-notes/previousReleases/#features_15","title":"Features","text":"<ul> <li>Default global image tag updated to 2202</li> </ul>"},{"location":"release-notes/previousReleases/#release-085-feb-7-2022","title":"Release 0.8.5 (Feb 7, 2022)","text":""},{"location":"release-notes/previousReleases/#features_16","title":"Features","text":"<ul> <li>PingCentral now supported. Example values application found here</li> </ul>"},{"location":"release-notes/previousReleases/#issues-resolved","title":"Issues Resolved","text":"<ul> <li>Issue #119 Workload template not honoring false values from values.yaml. Previously, false did not overwrite true in the Ping Identity Helm Chart template. This fix in _merge-util.tpl will resolve multiple cases within the Ping Identity Helm Chart.     <pre><code>{{- $globalValues := deepCopy $top.Values.global -}}\n{{- $prodValues := deepCopy (index $top.Values $prodName) -}}\n{{- $mergedValues := mergeOverwrite $globalValues $prodValues -}}\n</code></pre></li> <li>Issue #264 Update default global.image.tag to 2201</li> </ul>"},{"location":"release-notes/previousReleases/#release-084-jan-7-2022","title":"Release 0.8.4 (Jan 7, 2022)","text":"<ul> <li>Fix an issue that caused installation to fail when enabling <code>pingtoolkit</code></li> </ul>"},{"location":"release-notes/previousReleases/#release-083-jan-6-2022","title":"Release 0.8.3 (Jan 6, 2022)","text":""},{"location":"release-notes/previousReleases/#features_17","title":"Features","text":"<ul> <li>Document supported values</li> </ul>"},{"location":"release-notes/previousReleases/#issues-resolved_1","title":"Issues Resolved","text":"<ul> <li> <p>Issue #233 Ingress - semverCompare now retrieves correct K8 version for applying the correct apiVersion   <pre><code>{{- if semverCompare \"&gt;=1.19.x\" $top.Capabilities.KubeVersion.Version }}\n</code></pre></p> </li> <li> <p>Issue #254 Update default global.image.tag to 2112</p> </li> </ul>"},{"location":"release-notes/previousReleases/#release-082-dec-17-2021","title":"Release 0.8.2 (Dec 17, 2021)","text":"<ul> <li>Issue #238 Added support for running a utility sidecar alongside a product workload</li> </ul> <p>The <code>utilitySidecar</code> field under a given product can be used to run a sidecar container that will permanently alongside the product container. This sidecar can be used for utility command-line processes, such as running the collect-support-data tool or running a backup.</p> <p>An example can be found in the docs/examples/pingdirectory-backup directory for running a PingDirectory backup every 6 hours via a CronJob.</p> <pre><code>pingdirectory:\n  workload:\n    shareProcessNamespace: true\n  utilitySidecar:\n    enabled: true\n</code></pre> <ul> <li>Issue #247 Update default global.image.tag to 2111.1</li> </ul>"},{"location":"release-notes/previousReleases/#release-081-dec-6-2021","title":"Release 0.8.1 (Dec 6, 2021)","text":"<ul> <li>Issue #240 Fix failure on installation of 0.8.0 due to missing PingDirectory HTTP port value</li> </ul>"},{"location":"release-notes/previousReleases/#release-080-dec-6-2021","title":"Release 0.8.0 (Dec 6, 2021)","text":"<ul> <li>Issue #229 Support for shareProcessNamespace in pod spec</li> </ul> <p>A PingDirectory utility sidecar container needs to share the process namespace with the main PingDirectory container running in the same pod in order to get useful output out of tools like jps.   ### More support to come on the utility sidecar in future Helm release.</p> <ul> <li> <p>Issue #232 Update default global.image.tag to 2111</p> </li> <li> <p>Issue #239 Support for custom container arguments</p> </li> </ul> <pre><code>pingfederate-admin:\n  enabled: true\n  container:\n    args: [\"start-server\",\"tail -f /dev/null\"]\n</code></pre> <ul> <li>Issue #240 Allow specifying PingDirectory HTTPS port in values</li> </ul> <pre><code>pingdirectory:\n  enabled: true\n  services:\n    https:\n      containerPort: 8443\n</code></pre>"},{"location":"release-notes/previousReleases/#release-079-dec-1-2021","title":"Release 0.7.9 (Dec 1, 2021)","text":"<ul> <li>Issue #223 Support for HPA Scaling Behavior</li> </ul> <pre><code>clustering:\n  autoscaling:\n    enabled: true\n    behavior:\n      scaleDown:\n        stabilizationWindowSeconds: 300\n        policies:\n        - type: Percent\n          value: 100\n          periodSeconds: 15\n      scaleUp:\n        stabilizationWindowSeconds: 0\n        policies:\n        - type: Percent\n          value: 100\n          periodSeconds: 15\n        - type: Pods\n          value: 4\n          periodSeconds: 15\n        selectPolicy: Max\n</code></pre> <ul> <li> <p>Issue #231 Helm test image pull policy no longer hard-coded in <code>helm-charts/charts/ping-devops/templates/pinglib/_tests/tpl</code> <pre><code>- imagePullPolicy: IfNotPresent\n</code></pre></p> </li> <li> <p>Issue #233 Cluster service for pingaccess-admin in Multi-region   Support for multi-region PingAccess deployment without using an ingress. The headless service is an effective way to share the pod id across clusters.   <pre><code>pingaccess-admin:\nenabled: true\nprivateCert:\n  generate: true\nenvs:\n  SERVER_PROFILE_URL: https://github.com/pingidentity/pingidentity-server-profiles.git\n  SERVER_PROFILE_PATH: baseline/pingaccess\ncontainer:\n  replicaCount: 1\n  waitFor:\n    pingfederate-engine:\n      service: https\nservices:\n  https:\n    servicePort: 9000\n    containerPort: 9000\n    ingressPort: 443\n    dataService: true\n    clusterService: true\n  clusterconfig:\n    servicePort: 9090\n    containerPort: 9090\n    ingressPort: 443\n    dataService: true\n  clusterExternalDNSHostname: pingaccess-admin.usa.ping-multi-cluster.com\n</code></pre></p> </li> </ul>"},{"location":"release-notes/previousReleases/#release-078-nov-2-2021","title":"Release 0.7.8 (Nov 2, 2021)","text":"<ul> <li>Issue #213 Removed default SERVER_PROFILE variables from values.yaml</li> </ul> <pre><code>envs:\n- SERVER_PROFILE_URL:\n- SERVER_PROFILE_PATH:\n</code></pre> <ul> <li> <p>Issue #216 Add option to generate a master password for ping services</p> <p>In the interest of better security practice, this enhancement provides the ability to generate this password via the <code>derivedPassword</code> function in helm.  With this, several items can be used by default and overridden by the deployer to generate a secure password.  When it generates the password:</p> <ul> <li>A note will be added to the NOTES (see below)</li> <li>The password will be set into the global configmap PING_IDENTITY_PASSWORD. (we may want to use a secret instead)</li> </ul> <p>NOTES (see the generated password as well as the WARNING) <pre><code>$ helm upgrade --install test-pw pingidentity/ping-devops  --set global.masterPassword.enabled=true\nNOTES:\n#-------------------------------------------------------------------------------------\n# Ping DevOps\n#\n# Description: Ping Identity helm charts - 09/18/21\n#-------------------------------------------------------------------------------------\n# WARNING: Master Password has been requested and generated.  This is intended to\n#          generate a password for DEVELOPMENT PURPOSES ONLY.  This password will be\n#          assigned to the PING_IDENTITY_PASSWORD unless overridden by the values.\n#\n#          PING_IDENTITY_PASSWORD: **************\n#-------------------------------------------------------------------------------------\n</code></pre></p> <p>The values used to drive the creation of this password are:</p> <p>values.yaml <pre><code>global:\n  ############################################################\n  # Master Password Generation\n  #\n  # Uses Helm function derivePassword, which uses the master password\n  # specification: https://masterpassword.app/masterpassword-algorithm.pdf\n  #\n  #      masterPassword.enabled: {true | false}\n  #      masterPassword.strength: {master password template: long | maximum}\n  #      masterPassword.name: {defaults to .Release.Name}\n  #      masterPassword.site: {defaults to .Chart.Name}\n  #      masterPassword.secret: {defaults to .Release.Namespace}\n  ############################################################\n  masterPassword:\n    enabled: false\n    strength: long\n    name:   # default - .Release.Name\n    site:   # default - .Chart.Name\n    secret: # default - .Release.Namespace\n</code></pre></p> <p>As shown in the example above, a deployer only needs to provide the <code>global.masterPassword.enabled=true</code> to have it generated.</p> </li> <li> <p>Issue #221 PingDirectory service.x.containerPort updates to LDAPS_PORT environment variable</p> </li> <li>Issue #222 Update default global.image.tag to 2110</li> <li>Issue #224 External Hostname Annotations on PD data service</li> </ul>"},{"location":"release-notes/previousReleases/#release-077-oct-7-2021","title":"Release 0.7.7 (Oct 7, 2021)","text":"<ul> <li> <p>Issue #217 Update default security context group id to root (0)</p> <pre><code>global:\n  workload:\n    securityContext:\n      fsGroup: 0\n      runAsUser: 9031\n      runAsGroup: 0\n</code></pre> </li> <li> <p>Issue #218 Update default global.image.tag to 2109</p> </li> </ul>"},{"location":"release-notes/previousReleases/#release-076-sept-18-2021","title":"Release 0.7.6 (Sept 18, 2021)","text":"<ul> <li>Issue #209 Fix incorrect default ldap-sdk-tools probe exec commands</li> <li>Issue #210 Add helm-chart product/image pingtoolkit</li> <li>Issue #211 Allow for schedulerName to be provide on workloads (pods)</li> </ul>"},{"location":"release-notes/previousReleases/#release-075-august-30-2021","title":"Release 0.7.5 (August 30, 2021)","text":"<ul> <li>Issue #206 Bump default image tag to 2108</li> </ul>"},{"location":"release-notes/previousReleases/#release-074-august-26-2021","title":"Release 0.7.4 (August 26, 2021)","text":"<ul> <li> <p>Issue #196 Set initContainer settings from values.yaml instead of hard coded templates</p> <p>This issue was created since the initContainer resources were hard coded in the template, not allowing the implementor to provide their own values, causing issues when trying to deploy the pingfederate-engine in openshift.</p> <p>Moving a lot of the hard coded yaml out of the template files into the default values.yaml file.  This will give the implementor full control of how the initContainer runs.</p> <p>One breaking change with the values.yaml if anyone has overridden, is that the <code>{image name}</code> in the <code>global.externalImage.{name}: {image name}</code> value is moved into a map.  The default pingtoolkit externalImage looks like:</p> <pre><code>global:\n  externalImage:\n    pingtoolkit:\n      image: pingidentity/pingtoolkit:2107\n      imagePullPolicy: IfNotPresent\n      resources:\n        limits:\n          cpu: 1m\n          memory: 128Mi\n        requests:\n          cpu: 500m\n          memory: 64Mi\n      securityContext:\n        allowPrivilegeEscalation: false\n        capabilities:\n          drop:\n          - ALL\n        readOnlyRootFilesystem: true\n        runAsNonRoot: true\n        runAsUser: 9031\n        runAsGroup: 9999\n</code></pre> </li> <li> <p>Issue #203 testFramework - Support multiple waitFor products in testSteps</p> <p>When there are 2 waitFor's together, allow for combining them to run them within same initContainer, with a definition like:</p> <pre><code>  testSteps:\n    - name: 01-wait-for\n      waitFor:\n        pingfederate-admin:\n          service: https\n        pingfederate-engine:\n          service: https\n</code></pre> <p>creating a couple of initContainers of:</p> <pre><code>  initContainers:\n    - name: 01-wait-for-pingfederate-admin\n      ...\n    - name: 01-wait-for-pingfederate-engine\n      ...\n</code></pre> </li> </ul>"},{"location":"release-notes/previousReleases/#release-073-august-24-2021","title":"Release 0.7.3 (August 24, 2021)","text":"<ul> <li> <p>Issue #194 Change default envs for pingauthorize/pingauthorizepap</p> <p>The current envs for pingauthroize in the values.yaml file are:</p> <pre><code>  envs:\n    SERVER_PROFILE_URL: https://github.com/pingidentity/pingidentity-server-profiles.git\n    SERVER_PROFILE_PATH: paz-pap-integration/pingauthorize\n    SERVER_PROFILE_PARENT: PAZ\n    SERVER_PROFILE_PAZ_URL: https://github.com/pingidentity/pingidentity-server-profiles.git\n    SERVER_PROFILE_PAZ_PATH: baseline/pingauthorize\n</code></pre> <p>Just a side note here, the <code>baseline/pingauthorize</code> PATH includes a connection to pingdirectory, which will cause this to fail (pingauthorize https will return a 503).</p> <p>If someone wants to override these, they need to be sure to uset/override the <code>SERVER_PROFILE_PARENT</code> variable, so the parent profiles aren't brought in.</p> <p>The better default values.yaml should probably be:</p> <pre><code>  envs:\n    SERVER_PROFILE_URL: https://github.com/pingidentity/pingidentity-server-profiles.git\n    SERVER_PROFILE_PATH: getting-started/pingauthorize\n</code></pre> <p>For pingauthorizepap, it should have a default SERVER_PROFILE variables as empty, as no SERVER_PROFILE is needed by default.</p> </li> <li> <p>Issue #198 testFramework: Support full definition of initContainers attributes in testSteps and finalStep</p> <p>Update the testFramework to pull in all attributes of the testSteps and finalStep into the init containers and final container.  This allow for setting any resource, imagePullPolicy, ...</p> <p>This came about as there was no way to set resource or imagePullPolicy details.</p> <p>With this change, will be adding a couple of defaults into the value.yamls file for the finalStep:</p> <pre><code>  finalStep:\n    name: 99-completion\n    image: busybox\n    imagePullPolicy: IfNotPresent\n    command:\n      ...\n    resources:\n      limits:\n        cpu: 500m\n        memory: 128Mi\n      requests:\n        cpu: 1m\n        memory: 64Mi\n</code></pre> </li> </ul>"},{"location":"release-notes/previousReleases/#release-072-august-13-2021","title":"Release 0.7.2 (August 13, 2021)","text":"<ul> <li> <p>Issue #191 Change variable PF_ADMIN_BASEURL to PF_ADMIN_PUBLIC_BASEURL</p> <p>Release 0.7.2 created the new variable <code>PF_ADMIN_BASEURL</code>.  Due to the current user of the same variable with added <code>_PUBLIC_</code>,  the actual variable name needs to be <code>PF_ADMIN_PUBLIC_BASEURL</code>.</p> </li> </ul>"},{"location":"release-notes/previousReleases/#release-071-august-13-2021","title":"Release 0.7.1 (August 13, 2021)","text":"<ul> <li> <p>Issue #187 Create the PUBLIC hostname/ports in the global env vars configmap all the time</p> <p>Currently, the PUBLIC hostname/ports in the global env vars configmap are created if and only if the ingress in enabled.</p> <p>Normally, this would be fine, except that some of the products (i.e PingFederate) use the PUBLIC environment variable to setup items like BASE URLs and redirects for the browser.  This is required for use cases when there is no ingress, but the user creates a port forward, as well as testing with no ingresses.</p> <p>So, if no ingress is created, then the PUBLIC_HOSTNAMES should be set to <code>localhost</code> and the PUBLIC_PORT_* should be set to the same port as the contianerPort.</p> <p>If ingress is used, then the functionality will not be changed, and the public hostname will be constructed as well as the public ingressPort.</p> </li> <li> <p>Issue #188 Add the PF_ADMIN_BASEURL environment variable to the pingfederate admin/engine configmaps</p> <p>With the 10.3 release of PingFederate, there is a variable used to provide redirect links called the PF_ADMIN_BASEURL.  This needs to be set by the helm chart, as it will either be a public host or localhost, depending on if the ingress is available.  The container has no idea which it should be as it doesn't have insight into the environment it's running.</p> <p>If ingress is enabled, an example for this variable is:</p> <pre><code>PF_ADMIN_BAESURL=https://pingfederate-admin.example.com\n</code></pre> <p>If ingress is not enable, an example for this variable:</p> <pre><code>PF_ADMIN_BASEURL=https://localhost:9999\n</code></pre> </li> </ul>"},{"location":"release-notes/previousReleases/#release-070-august-09-2021","title":"Release 0.7.0 (August 09, 2021)","text":"<ul> <li> <p>Issue #184 Create default ServiceAccount/Role/RoleBinding for testFramework</p> <p>To allow for a role to be created during testing, an <code>rbac</code> section is added to the <code>testFramework</code> allowing for the definition of that Role.  If enabled, it will create a ServiceAccount, Role and RoleBinding using the same naming rules of resources and add that serviceAccount to the test pod.</p> <p>testFramework default rbac set to:</p> <pre><code>  #########################################################\n  # If rbac is enabled, this will create:\n  #   - serviceAccount\n  #   - role\n  #   - roleBinding (between serviceAccount and role)\n  #\n  # and apply the serviceAccount to the pod in the tests.\n  # The names for these resources will be named using the\n  # naming rules for all resources including the ReleaseName\n  #########################################################\n  rbac:\n    enabled: true\n    role:\n      rules:\n      - apiGroups:\n        - '*'\n        resources:\n        - '*'\n        verbs:\n        - '*'\n</code></pre> </li> </ul>"},{"location":"release-notes/previousReleases/#release-069-august-06-2021","title":"Release 0.6.9 (August 06, 2021)","text":"<ul> <li>Issue #179 Bump default image tag to 2107</li> <li>Issue #182 Set default startupProbe.timeoutSeconds to 5</li> <li> <p>Issue #180 Enhance testFramework to support additional pod level configurations</p> <p>When using the testFramework there are additional pod level config items that need to be provided (i.e. serviceAccountName) along with the existing securityContext.</p> <p>To allow for any item to be configured, we should add a testFramework.pod that will pull in all items into the testFramework pod definition.</p> <p>Example: <pre><code>testFramework:\n  #########################################################\n  # Pod information to include\n  #\n  # Examples:\n  #   securityContext for all containers\n  #   serviceAccount for all containers\n  #########################################################\n  pod:\n    securityContext:\n      runAsUser: 1000\n      runAsGroup: 2000\n    serviceAccount: serviceaccount-name\n</code></pre></p> <p>Breaking changes</p> <p>Note: that this will be a breaking change for anyone who has created a <code>testFramework.securityContext</code>.  If this is the case, they need to add <code>pod</code> in front of <code>securityContext</code>.</p> </li> </ul>"},{"location":"release-notes/previousReleases/#release-068-july-29-2021","title":"Release 0.6.8 (July 29, 2021)","text":"<ul> <li> <p>Issue #175 Invalid ingress resources on Kubernetes clusters &gt; 1.18</p> <p>During resoluton of issue #170 providing support for ingress apiVersion v1, the necessary ingress yaml fields wearn't updated to relfect that new version. This is a fix.  The backend definition of the Ingress will now reflect the proper definition based on a v1 or v1beta1 apiVersion.</p> <p>Example: If KubeVersion &gt; 1.18</p> <pre><code>      service:\n        name: https\n        port:\n          number: 443\n</code></pre> <p>Example: If KubeVersion &lt;= 1.18</p> <pre><code>      serviceName: https\n      servicePort: 443\n</code></pre> <p>Additionally, adding the pathType for all versions as it is now required in ingress v1.</p> </li> </ul>"},{"location":"release-notes/previousReleases/#release-067-july-28-2021","title":"Release 0.6.7 (July 28, 2021)","text":"<ul> <li> <p>Issue #170 Update Ingress resource kind</p> <p>If kubernetes vesion is &gt;1.18, setting the ingress apiVersion to <code>v1</code>.  Otherwise, current default will be used <code>v1beta1</code>.</p> </li> <li> <p>Issue #171 Reevaluate Lifecycle probes</p> <p>Adding startupProble as well as re-organizing how the probes are defined, allowing the deployer to use standard k8s probe definitions out of the box.</p> <ol> <li>Moving the probes section under global.container</li> <li>Changing names: (liveness --&gt; livenessProbe, readiness --&gt; readinessProbe)</li> <li>Adding startupProbe</li> </ol> <p>The new default looks like:</p> <pre><code>    ############################################################\n# Probes\n#\n# Probes have a number of fields that you can use to more precisely control the\n# behavior of liveness and readiness checks.\n#\n# https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/\n############################################################\nprobes:\nlivenessProbe:\nexec:\ncommand:\n- /opt/liveness.sh\ninitialDelaySeconds: 30\nperiodSeconds: 30\ntimeoutSeconds: 5\nsuccessThreshold: 1\nfailureThreshold: 4\nreadinessProbe:\nexec:\ncommand:\n- /opt/readiness.sh\ninitialDelaySeconds: 30\nperiodSeconds: 5\ntimeoutSeconds: 5\nsuccessThreshold: 1\nfailureThreshold: 4\nstartupProbe:\nexec:\ncommand:\n- /opt/liveness.sh\nperiodSeconds: 10\nfailureThreshold: 90\n</code></pre> <p>Breaking Changes</p> <p>This is a breaking change if anyone has overriding probes in their own values file.  The fix is simply move their definition of their probes to live under global.container or the (productName).container, as well as adding \"Probe\" to the definition.</p> </li> </ul>"},{"location":"release-notes/previousReleases/#release-066-july-7-2021","title":"Release 0.6.6 (July 7, 2021)","text":"<ul> <li>Issue #160 Change default image tag to 2106</li> <li> <p>Issue #166 Add securityContexts to testFramework containers</p> <ul> <li>Adding ability to provide a securityContext at the following levels:</li> <li> <p>Changing the default finalStep image to busybox</p> <pre><code>testFramework:\n  ...\n  #########################################################\n  # SecurityContext for all containers\n  #########################################################\n  securityContext:\n    runAsUser: 1000\n    runAsGroup: 2000\n    ...\n    testSteps:\n    - name: 01-init-example\n      ...\n      securityContext:\n        runAsUser: ...\n    ...\n    finalStep:\n      securityContext:\n        runAsUser: ...\n</code></pre> </li> </ul> </li> <li> <p>Issue #167 Disable testFramework by default     To enable, simply:</p> <pre><code>testFramework:\nenabled: true\n...\n</code></pre> </li> </ul>"},{"location":"release-notes/previousReleases/#release-065-july-4-2021","title":"Release 0.6.5 (July 4, 2021)","text":"<ul> <li> <p>Issue #163 Add PingAuthorize and     PingAuthorizePAP to helm charts.</p> <p>Includes pre-release to PingAuthorize 8.3</p> <p>This includes the necessary config for PingAuthorize and PingAuthorizePAP even though there isn't a release for 2105.  The current edge release is required to use the default server-profiles provided in the values.yaml.  Once the global tag is changed to 2106 (over next few days) PingAuthorize will be default for use over PingDataGoverance.  This will be tracked in a ticket released 2105.</p> <p>Example yaml to test PingAuthoize/PAP</p> <pre><code>pingdataconsole:\nenabled: true\n\npingdirectory:\nenabled: true\n\npingauthorize:\nimage:\ntag: 8.3.0.0-edge\nenabled: true\n\npingauthorizepap:\nenabled: true\n</code></pre> </li> </ul>"},{"location":"release-notes/previousReleases/#release-064-july-1-2021","title":"Release 0.6.4 (July 1, 2021)","text":"<ul> <li> <p>Issue #158 Increment default tag to 2105     Sidecars and initContainers are valuable for a multitude of reasons - log forwarding, metric exporting, backup jobs. Because of this they can also have many ways of being configured.</p> <p>Allow for defining three top level maps to provide details for:</p> <ul> <li>sidecars - Defines sidecar containers to be run alongside product containers.</li> <li>initContainers - Defines initContainers to be run before product containers.</li> <li>volumes - Defines volumes used by sidecars, initContainers and product containers.</li> </ul> <p>Example definitions</p> <pre><code>sidecars:\npd-access-logger:\nname: pd-access-log-container\nimage: pingidentity/pingtoolkit:2105\nvolumeMounts:\n- mountPath: /tmp/pd-access-logs/\nname: pd-access-logs\nreadOnly: false\nstatsd-exporter:\nname: statsd-exporter\nimage: prom/statsd-exporter:v0.14.1\nargs:\n- \"--statsd.mapping-config=/tmp/mapping/statsd-mapping.yml\"\n- \"--statsd.listen-udp=:8125\"\n- \"--web.listen-address=:9102\"\nports:\n- containerPort: 9102\nprotocol: TCP\n- containerPort: 8125\nprotocol: UDP\n\ninitContainers:\ninit-1:\nname: 01-init\nimage: pingidentity/pingtoolkit:2105\ncommand: ['sh', '-c', 'echo \"Initing 1\" &amp;&amp; touch /tmp/pd-access-logs/init-1']\nvolumeMounts:\n- mountPath: /tmp/pd-access-logs/\nname: pd-access-logs\nreadOnly: false\n\nvolumes:\npd-access-logs:\nemptyDir: {}\nstatsd-mapping:\nconfigMap:\nname: statsd-config\nitems:\n- key: config\npath: statsd-mapping.yml\n</code></pre> <p>And within the product (or global) definition, allow for inclusion of sidecars, initContainers and volumes.  These must be available in the top-level <code>sidecars:</code>, <code>initContainers:</code> and <code>volumes:</code></p> <ul> <li>includeSidecars</li> <li>includeInitContainers - Run in order as listed in array</li> <li>includeVolumes</li> </ul> <p>Example usages</p> <pre><code>pingdirectory:\n...\nincludeSidecars:\n- pd-access-logger\nincludeInitContainers:\n- init-1\nincludeVolumes:\n- pd-access-logs\n\nvolumeMounts:\n- mountPath: /opt/access-logs/\nname: pd-access-logs\n</code></pre> </li> </ul>"},{"location":"release-notes/previousReleases/#release-063-june-21-2021","title":"Release 0.6.3 (June 21, 2021)","text":"<ul> <li>Issue #154 Increment default tag to 2105</li> <li>Issue #155 Add clusterServiceName to product services with service clusters</li> </ul>"},{"location":"release-notes/previousReleases/#release-062-may-24-2021","title":"Release 0.6.2 (May 24, 2021)","text":"<ul> <li> <p>Issue #151 Add support for Container LifeCycle Event Hooks</p> <p>Adding following to values.yaml</p> <p>Adding lifecycle hooks to container</p> <pre><code>global:\n############################################################\n# container life handlers, allowing for lifecycle events such\n# as postStart and preStop events\n#\n# https://kubernetes.io/docs/tasks/configure-pod-container/attach-handler-lifecycle-event\n############################################################\nlifecyle: {}\n# Example\n# lifecyle:\n#   postStart:\n#     exec:\n#       command: [\"/bin/sh\", \"-c\", \"echo Start Complete &gt; /tmp/message\"]\n</code></pre> </li> <li> <p>General cleanup of values.yaml comments</p> </li> <li> <p>Setting default <code>externalImages.pingtoolkit</code> tag to 2104, and removing <code>edge</code> tag from <code>ldap-sdk-tools</code> image   which will now default to same <code>global.image.tag</code> setting (currently 2104)</p> </li> </ul>"},{"location":"release-notes/previousReleases/#release-061-may-21-2021","title":"Release 0.6.1 (May 21, 2021)","text":"<ul> <li> <p>Issue #148 Calculate checksum of ConfigMaps based   on the data rather than entire ConfigMap file</p> <p>This will only use the ConfigMap.data when creating checksums in workload rather than using the entire file.  It will result in no checksum change when labels/annotations are the only thing changing. A good example is the helm chart version, which changes the label, but not data.</p> </li> </ul>"},{"location":"release-notes/previousReleases/#release-060-may-11-2021","title":"Release 0.6.0 (May 11, 2021)","text":"<ul> <li> <p>Changed default <code>global.image.pullPolicy</code> from <code>Always</code> to <code>IfNotPresent</code>.</p> <p>This is due to the fact that the <code>global.image.tag</code> is a non-floating tag. Once it is downloaded and present, it will not change.  This small change will increase performance at startup as images are typically present when installing/updating releases.</p> <p>Simply set <code>global.image.pullPolicy=Always</code> to pull every time if needed.</p> </li> <li> <p>BETA 2 - Testing Framework supporting <code>helm test</code> command and associated <code>testFramework</code> values.</p> <p>Cleaned up the generation of resources honoring the addReleaseNameToResource setting.</p> </li> </ul>"},{"location":"release-notes/previousReleases/#release-059-may-10-2021","title":"Release 0.5.9 (May 10, 2021)","text":"<ul> <li> <p>BETA 1 - Testing Framework supporting <code>helm test</code> command and associated <code>testFramework</code> values.</p> <p>A testing framework is being created to allow for testing Ping Identity helm chart deployments using a <code>testFramework</code> set of values.  This is currently in beta, with documentation to available soon. Expect that changes will be made to this work, until it's fully released with documentation.</p> </li> </ul>"},{"location":"release-notes/previousReleases/#release-058-may-6-2021","title":"Release 0.5.8 (May 6, 2021)","text":"<ul> <li> <p>Issue #141 Fix DNS_QUERY_LOCATION on pingfederate-engine configmap.yaml</p> <p>Resolves an issue with the DNS_QUERY_LOCATION when pingfederate clustering is used for &gt;1 pingfederate-engines</p> </li> </ul>"},{"location":"release-notes/previousReleases/#release-057-may-3-2021","title":"Release 0.5.7 (May 3, 2021)","text":"<ul> <li> <p>Issue #136 ClusterIP Services   port/targetPort be set to the containerPort</p> <p>Since the ClusterIP Services (aka Headless services) only provide access to the underlying container IP and port.  The port, and by default targetPort, will be set to the containerPort value.  The helm charts will start requiring the containerPort for any service where clusterService:true is set, otherwise it will fail with an error message.</p> </li> <li> <p>Issue #138 Update image.tag to 2104 (April 2021)</p> </li> </ul>"},{"location":"release-notes/previousReleases/#release-055-april-29-2021","title":"Release 0.5.5 (April 29, 2021)","text":"<ul> <li> <p>Issue #133 - Change default pingdirectory values   (container.resources.requests.cpu=50m and container.replicaCount=1)</p> <p>Setting the cpu request to 50m, will provide at last some reservation of CPU, so that if there are multiple nodes, it will better even out the load.</p> <p>Additionally, setting the replicaCount to 1 by default, as many cases in development, there isn't a great need to have multiple replicas. If this is the case, simply set pingdirectory.container.replicaCount=2 or any number of replica's.</p> </li> <li> <p>Issue #132 - Adding PingDirectoryProxy to mix of products</p> </li> </ul>"},{"location":"release-notes/previousReleases/#release-055","title":"Release 0.5.5","text":"<ul> <li> <p>Issue #126 - Unable to mount secretVolume and configMapVolumes simultaneously</p> <p>This is one additional fix to the the same thing fixed in 0.5.4.  <code>volumeMounts:</code> had the same issue as <code>volumes:</code>.  This completes and resolves issue #126.</p> </li> </ul>"},{"location":"release-notes/previousReleases/#release-054","title":"Release 0.5.4","text":"<ul> <li> <p>Issue #126 - Unable to mount secretVolume and configMapVolumes simultaneously</p> <p>Due to the fact that volumes: is an array of items volumes: usage with secret or configMap volumes exosed the issue that multiple volumes: entries were used, and only kept the last one.  Fix included only using volumes: once.  Note that the template will end up with a <code>volumes: null</code> if none are set (i.e. deployment with no Secret/ConfigMap volumes), but that is ok.</p> </li> </ul>"},{"location":"release-notes/previousReleases/#release-053","title":"Release 0.5.3","text":"<ul> <li> <p>Issue #121 - Create global-env-vars hosts/ports   for all products regardless if enabled</p> <p>The status of this config map is used to form the checksum for the products. This will ensure that a simple addition/deletion of a product from the deployed mix won't cause all products to be restarted.</p> </li> <li> <p>Issue #122 - Update image.tag to 2103 (March 2021)</p> <p>The image tag is modified to 2103. This includes:</p> <ul> <li>Security Context on StatefulSets to include a fsGroup=9999 (same as gid)</li> <li>Update the services ContainerPort to unprivileged ports (i..e. 636 --&gt; 1636)</li> </ul> </li> </ul>"},{"location":"release-notes/previousReleases/#release-052","title":"Release 0.5.2","text":"<ul> <li> <p>Issue #113 - Default pingaccess-admin   to StatefulSet</p> <p>In order to provide HA with a PingAccess cluster between admin/engine nodes, it is required that the PingAccess Admin deploy as a StatefulSet with persistence. Otherwise if the PingAccess Admin goes down, the engines would lose connectivity to that node and be unable to get further config updates and subsequently have to bounce and lose their web-session information.</p> <p>The new default yaml</p> <pre><code>pingaccess-admin:\nworkload:\ntype: StatefulSet\n</code></pre> </li> <li> <p>Issue #95 - Fix default   serviceAccount in workload for vault</p> <p>Fixed issue that was created in Issue 95 (using annotations to provide vault details) to pull serviceAccountName from the proper location in annotations.</p> <pre><code>  vault:\n    hashicorp:\n      annotations:\n        serviceAccountName: vault-auth\n</code></pre> </li> <li> <p>Issue #116 - Support Annotations   at Workload Level.</p> <p>Support annotations at the workload level. For workloads, adding <code>.spec.template.metadata</code>.</p> <p>Example telegraf annotation</p> <p><pre><code>pingfederate-engine:\n  workload:\n    annotations:\n      telegraf.influxdata.com/class: app\n</code></pre> would lead to: <pre><code>apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app.kubernetes.io/instance: samir\n    app.kubernetes.io/managed-by: Helm\n    app.kubernetes.io/name: pingfederate-engine\n    helm.sh/chart: ping-devops-0.5.1\n  name: samir-pingfederate-engine\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app.kubernetes.io/instance: samir\n      app.kubernetes.io/name: pingfederate-engine\n  strategy:\n    rollingUpdate:\n      maxSurge: 1\n      maxUnavailable: 0\n    type: RollingUpdate\n  template:\n    metadata:\n      annotations:\n        telegraf.influxdata.com/class: app\n</code></pre></p> </li> <li> <p>Issue #117 - Bug - cluster service   shouldn't use image name for service name.</p> </li> <li> <p>Issue #114 - Revamp vault.hashicorp.secrets value .yaml and support per path secret   Detailed documentation on this can be found the Vault Config docs</p> </li> </ul>"},{"location":"release-notes/previousReleases/#release-051","title":"Release 0.5.1","text":"<ul> <li> <p>Added back in the service name by default to the private cert generation pulled out of the previous release by accident.</p> <p>If the product was <code>pingaccess-admin</code> and release was <code>acme</code>, then the service name might be <code>acme-ping-access-admin</code>. This name by default will be added to the alternative hosts of the private certificate generation by default.  Without this the pingaccess clustering will fail during setup.</p> </li> </ul>"},{"location":"release-notes/previousReleases/#release-050","title":"Release 0.5.0","text":"<ul> <li> <p>Issue #103 - Provide ability to add additional alt-names/alt-ips to private cert generation</p> <p>Allow for a privateCert structure to contain optional arrays <code>additionalHosts</code> and <code>additionalIPs</code>:</p> <pre><code>pingaccess-admin:\n  privateCert:\n    generate: true\n    additionalHosts:\n    - pingaccess-admin.west-cluster.example.com\n    - pa-admin.west-cluster.example.com\n    additionalIPs:\n    - 123.45.67.8\n</code></pre> <p>In addition, if the ingress for the product is enabled, the host(s) created for that ingress will also be added to the alt-names.</p> <p>The above example (with an ingress) will create a cert used by pingaccess-admin containing:</p> <pre><code>Certificate:\n    Data:\n        ...\n    Signature Algorithm: sha256WithRSAEncryption\n        Issuer: CN=pingaccess-admin\n        ...\n        X509v3 extensions:\n            ...\n            X509v3 Subject Alternative Name:\n                DNS:rel050-pa-pingaccess-admin.ping-devops.com. pingaccess-admin.west-cluster.example.com, DNS:pa-admin.west-cluster.example.com, IP Address:123.45.67.8\n</code></pre> </li> </ul>"},{"location":"release-notes/previousReleases/#release-049","title":"Release 0.4.9","text":"<ul> <li> <p>Issue #104 - Update default global image tag to 2102 (Feb 2021)</p> <p>Update the default global image tag in base values.yaml and remove edge from example yamls.</p> </li> </ul>"},{"location":"release-notes/previousReleases/#release-048","title":"Release 0.4.8","text":"<ul> <li> <p>Issue #100 - Change pingfederate-engine HPA to a default of disabled</p> <p>Changing the default value <code>pingfederate-engine.clustering.autoscaling.enabled=false</code>, since the default CPU Request is set to 0.</p> </li> </ul>"},{"location":"release-notes/previousReleases/#release-047","title":"Release 0.4.7","text":"<ul> <li> <p>Issue #95 - Unable to set numerous Vault configuration options</p> <p>Updated ability to add any hashicorp.vault annotation to the workload.  As part of this effort, the existing name/values have been deprecated, however will continue to work for a period of time.</p> <p>Updated details can be found in the Vault Config docs.</p> </li> <li> <p>Issue #97 - Add the ability to add annotations to all resources generated   similar to current support for Labels.  This will allow deployers to specify additional annotations at either the global and/or product level.   An example of the values yaml would look like:</p> <pre><code>global:\n  annotations:\n    app.ping-devops.com/test: test-name\n\npingaccess-admin:\n  annotations:\n    app.pingaccess/version: v1234\n</code></pre> </li> <li> <p>Additional cleanup of Notes.txt outputting detail of deployment.</p> </li> </ul>"},{"location":"release-notes/previousReleases/#release-046","title":"Release 0.4.6","text":"<ul> <li>Minor follow on update to cpu/memory request/limit sizes for init containers.</li> </ul>"},{"location":"release-notes/previousReleases/#release-045","title":"Release 0.4.5","text":"<ul> <li> <p>Issue #89 - Update default workload resource cpu/memory request sizes.</p> <p>Updating defaults to create a usage better reflecting actual memory usage by product. And minimizing amount of CPU needed as testing generally utilizes very little.  Of course, it is definitely recommended that production deployments specify amount of cpu and memory required and limited to.</p> <p>Current defaults are set to:</p> <pre><code>#-------------------------------------------------------------------------------------\n# Ping DevOps\n#\n# Description: All Ping Identity product images with integration\n#-------------------------------------------------------------------------------------\n#\n#           Product         Workload   cpu-R cpu-L mem-R mem-L  Ing\n#    --------------------- ----------- ----- ----- ----- ----- -----\n#  \u221a pingaccess-admin      deployment  0     2     1Gi   4Gi   false\n#  \u221a pingaccess-engine     deployment  0     2     1Gi   4Gi   false\n#  \u221a pingdataconsole       deployment  0     2     .5Gi  2Gi   false\n#  \u221a pingdatagovernance    deployment  0     2     1.5Gi 4Gi   false\n#  \u221a pingdatagovernancepap deployment  0     2     .75Gi 2Gi   false\n#  \u221a pingdatasync          deployment  0     2     .75Gi 2Gi   false\n#  \u221a pingdelegator         deployment  0     500m  32Mi  64Mi  false\n#  \u221a pingdirectory         statefulset 0     2     2Gi   8Gi   false\n#  \u221a pingfederate-admin    deployment  0     2     1Gi   4Gi   false\n#  \u221a pingfederate-engine   deployment  0     2     1Gi   4Gi   false\n#\n#  \u221a ldap-sdk-tools        deployment  0     0     0     0     false\n#  \u221a pd-replication-timing deployment  0     0     0     0     false\n#\n#-------------------------------------------------------------------------------------\n</code></pre> </li> </ul>"},{"location":"release-notes/previousReleases/#release-044","title":"Release 0.4.4","text":"<ul> <li> <p>Issue #80 - Add support for importing a secret containing license into the container.   Adds ability to add secret and configMap data to a container via a VolumeMount.  A good use of this practice - bringing product   licenses into the container.</p> <p>Example of creating 3 volume mounts in container from secret and configMap</p> <pre><code>pingfederate-admin\nsecretVolumes:\npingfederate-license:\nitems:\nlicense: /opt/in/instance/server/default/conf/pingfederate.lic\nhello: /opt/in/instance/server/default/hello.txt\n\nconfigMapVolumes:\npingfederate-props:\nitems:\npf-props: /opt/in/etc/pingfederate.properties\n</code></pre> <p>In this case, a secret (called pingfederate-license) and configMap (called pingfederate-props) will bring in a   couple of key values (license, hello) and (pf-props) into the container as specific files. The results will looks like:</p> <p>Example of kubectl describe of pingfederate-admin container</p> <pre><code>Containers:\n  pingfederate-admin:\n    Mounts:\n      /opt/in/etc/pingfederate.properties from pingfederate-props (ro,path=\"pingfederate.properties\")\n      /opt/in/instance/server/default/conf/pingfederate.lic from pingfederate-license (ro,path=\"pingfederate.lic\")\n      /opt/in/instance/server/default/hello.txt from pingfederate-license (ro,path=\"hello.txt\")\nVolumes:\n  pingfederate-license:\n    Type:        Secret (a volume populated by a Secret)\n    SecretName:  pingfederate-license\n    Optional:    false\n  pingfederate-props:\n    Type:      ConfigMap (a volume populated by a ConfigMap)\n    Name:      pingfederate-props\n    Optional:  false\n</code></pre> </li> </ul>"},{"location":"release-notes/previousReleases/#release-043","title":"Release 0.4.3","text":"<ul> <li>Issue #83 - Remove old pingdirectory tag check when creating service-cluster.   This caused issues when creating a pingdirectory deployment with most recent tags (tags other than edge or 2012).</li> </ul>"},{"location":"release-notes/previousReleases/#release-042","title":"Release 0.4.2","text":"<ul> <li>Issue #79 - Adding support for product PingDataGovernance PAP</li> <li> <p>Issue #78 - Adding support to provide affinity definition to the workload of a product.</p> <p>Example values.yaml to add podAntiAffinity to pingdirectory</p> <pre><code>pingdirectory:\ncontainer:\naffinity:\npodAntiAffinity:\n# Add a hard requirement for each PD pod to be deployed to a different node\nrequiredDuringSchedulingIgnoredDuringExecution:\n- labelSelector:\nmatchExpressions:\n- key: app.kubernetes.io/name\noperator: In\nvalues:\n- pingdirectory\ntopologyKey: \"kubernetes.io/hostname\"\n# Add a soft requirement for each PD pod to be deployed to a different AZ\npreferredDuringSchedulingIgnoredDuringExecution:\n- weight: 1\npodAffinityTerm:\nlabelSelector:\nmatchExpressions:\n- key: app.kubernetes.io/name\noperator: In\nvalues:\n- pingdirectory\ntopologyKey: \"failure-domain.beta.kubernetes.io/zone\"\n</code></pre> </li> </ul>"},{"location":"release-notes/previousReleases/#release-041","title":"Release 0.4.1","text":"<ul> <li>Change default image tag to <code>2101</code> (January 2021).</li> <li> <p>Create private certs and keystore for use by images, only if the value   <code>{product-name}.privateCert.generate=true</code>.  Defaults are false.</p> <ul> <li>Helm will generate the a <code>tls.crt</code> and <code>tls.key</code>, place it into a kubernetes   secret called <code>{release-productname}-private-cert</code>.</li> <li>Mount the secret into the image under <code>/run/secrets/private-cert</code></li> <li>An init container will pull the <code>tls.crt</code> and <code>tls.key</code> into a pkcs12   keystore and place it into a file <code>/run/secrets/private-keystore/keystore.env</code>   that will be mounted into the running container.</li> <li>When the container's hooks are running, it will source the environment variables   in this <code>keystore.env</code>.  The default variables set are:<ul> <li><code>PRIVATE_KEYSTORE_PIN={base64 random pin}</code></li> <li><code>PRIVATE_KEYSTORE_TYPE=pkcs12</code></li> <li><code>PRIVATE_KEYSTORE={pkcs12 keystore}</code></li> </ul> </li> </ul> <p>yaml to generate a private cert/keystore for pingaccess-admin</p> <pre><code>pingaccess-admin:\nprivateCert:\ngenerate: true\n</code></pre> <p>Example of created /run/secrets/private-keystore/keystore.env</p> <pre><code>PRIVATE_KEYSTORE_PIN=nrZmV4XdfK....\nPRIVATE_KEYSTORE_TYPE=pkcs12\nPRIVATE_KEYSTORE=MIIJgQIBAzCCCUcGC....\n</code></pre> </li> <li> <p>Added support for PingAccess clustering between pingaccess-admin and multiple   pingaccess-engine containers.</p> <ul> <li>See everything.yaml for example of deploying     a PingAccess cluster using PingFederate/PingDirectory to authenticate</li> <li>It is required to either:<ul> <li>generate the private cert (see above)     with the value of <code>pingaccess-admin.privateCert.generate=true</code> or</li> <li>provide your own cert secret called <code>{release-productname}-private-cert</code>     containing a valid <code>tls.crt</code> and <code>tls.key</code>.</li> </ul> </li> <li>Enable both the <code>pingaccess-admin</code> and <code>pingaccess-engine</code> helm chart products</li> </ul> <p>Example values to create a clustered pingaccess</p> <pre><code>pingaccess-admin:\nenabled: true\nprivateCert:\ngenerate: true\nenvs:\nSERVER_PROFILE_URL: https://github.com/pingidentity/pingidentity-server-profiles.git\nSERVER_PROFILE_PATH: baseline/pingaccess\n\npingaccess-engine:\nenabled: true\nenvs:\nSERVER_PROFILE_URL: https://github.com/pingidentity/pingidentity-server-profiles.git\nSERVER_PROFILE_PATH: baseline/pingaccess\n\npingfederate-admin:\nenabled: true\nenvs:\nSERVER_PROFILE_URL: https://github.com/pingidentity/pingidentity-server-profiles.git\nSERVER_PROFILE_PATH: baseline/pingfederate\ncontainer:\nwaitFor:\npingdirectory:\nservice: ldaps\n\npingfederate-engine:\nenabled: true\nenvs:\nSERVER_PROFILE_URL: https://github.com/pingidentity/pingidentity-server-profiles.git\nSERVER_PROFILE_PATH: baseline/pingfederate\n\npingdirectory:\nenabled: true\nenvs:\nSERVER_PROFILE_URL: https://github.com/pingidentity/pingidentity-server-profiles.git\nSERVER_PROFILE_PATH: baseline/pingdirectory\n</code></pre> </li> </ul>"},{"location":"release-notes/previousReleases/#release-040","title":"Release 0.4.0","text":"<ul> <li> <p>Support availability of PingDirectory pods through the cluster headless kubernetes service.   Allows for PingDirectory nodes to find one another during the replication enable/init process.</p> <p>Adds following to pingdirectory-cluster</p> <pre><code>metadata:\nannotations:\nservice.alpha.kubernetes.io/tolerate-unready-endpoints: \"true\"\nspec:\npublishNotReadyAddresses: true\n</code></pre> </li> </ul>"},{"location":"release-notes/previousReleases/#release-039","title":"Release 0.3.9","text":"<ul> <li>Fixed the default wait-for service name on pingfederate-engine (admin --&gt; https).</li> <li>Changed default on readiness command to check for readiness every 5 seconds rather than 30.   This allows for availability on some services, such as PingFederate which is normally ready in 30 sec.</li> </ul>"},{"location":"release-notes/previousReleases/#release-038","title":"Release 0.3.8","text":"<ul> <li> <p>Issue #56 - Improved Default Naming on Global vars - PORTs</p> </li> <li> <p>Issue #56 - Improved Default Naming on Global vars - PORTs</p> <p>In release 0.3.6, global-env-vars were created for PORTS.  The naming structure used was complex and difficult, primarily because a product can have several ports open on a particular private and public host.  The format will be more consistent as defined by the following:</p> <p><code>{product-short-code with type}_{public or private}_{hostname or port}{_service if port}</code></p> <p>An example with PD might look like (note the service names of <code>https</code> and <code>data-api</code>):</p> <pre><code>PD_ENGINE_PUBLIC_PORT_HTTPS: 443\nPD_ENGINE_PUBLIC_PORT_DATA_API: 1443\n\nPD_ENGINE_PRIVATE_PORT_HTTPS: 443\nPD_ENGINE_PRIVATE_PORT_DATA_API: 8443\n</code></pre> </li> <li> <p>Issue #62 -   When creating configMapRef's, take into account the proper release name to include</p> <p>ConfigMapRef names in workloads were not consistent with the ConfigMaps created by default when taking into account the <code>addReleaseNameToResource</code> setting of prepend, append or none. This fixes that issue ensuring that config maps are consistent.</p> </li> <li> <p>Added global-env private/public host/port for PingDataConsole, which was missing.</p> </li> <li>Changed the default pingfederate-admin <code>admin</code> service name to <code>https</code> to reduce confusion.</li> <li>Changed the default pingfederate-engine <code>engine</code> service name to <code>https</code> to reduce confusion.</li> </ul>"},{"location":"release-notes/previousReleases/#release-037","title":"Release 0.3.7","text":"<ul> <li>Fixes issue with service -vs- ingress name on creation of ingress to service mapping.  Resolves issue #57.</li> </ul>"},{"location":"release-notes/previousReleases/#release-036","title":"Release 0.3.6","text":"<ul> <li> <p>Cleaning up and making services/ingresses easier to use together.  Incorporating all the ports   used in both a service and ingress into the same location of the services structure.</p> <p>The example below shows a container/service/ingress and how to specify the ports at each level.</p> <ul> <li><code>containerPort</code> - Replaces <code>targetPort</code></li> <li><code>servicePort</code> - Replaces <code>port</code></li> <li><code>ingressPort</code> - New entry</li> </ul> <pre><code>  services:\napi:\ncontainerPort: 8443 &lt;--- changed from targetPort\nservicePort: 1443   &lt;--- changed from port\ningressPort: 443    &lt;--- new.  moved from ingress\ndataService: true\ndata-api:\ncontainerPort: 9443 &lt;--- changed from targetPort\nservicePort: 2443   &lt;--- changed from port\ningressPort: 2443   &lt;--- new.  moved from ingress\ndataService: true\ningress:\nhosts:\n- host: pingdirectory.example.com\npaths:\n- path: /api\nbackend:\nserviceName: api        &lt;--- changed from servicePort\n- path: /directory/v1\nbackend:\nserviceName: data-api   &lt;--- changed from servicePort\n</code></pre> <p>Additionally, <code>global-env-vars</code> will be created for each of these ports.  If the name of the product is <code>PROD</code>, the the following ports would be created:</p> <pre><code>  PROD_API_PRIVATE_PORT=\"1443\"          # This is the servicePort\nPROD_API_PUBLIC_PORT=\"443\"            # This is the ingressPort\nPROD_DATA_API_PRIVATE_PORT=\"2443\"\nPROD_DATA_API_PUBLIC_PORT=\"2443\"\n</code></pre> </li> <li> <p>Fixed missing <code>USER_BASE_DN</code> setting in simple-sync.yaml example.</p> </li> </ul>"},{"location":"release-notes/previousReleases/#release-035","title":"Release 0.3.5","text":"<ul> <li> <p>Allowing config values to determine use of init containers to wait-for other chart products.   For each product, you can now provide a <code>waitFor</code> structure providing the name   and service that should be waited on before the running container con continue.  This   will basically inject an initContainer using the PingToolkit wait-for utility until it   can <code>nc host:port</code> before continuing.</p> <p>PingFederate Admin waiting on pingdirectory ldaps service to be available</p> <pre><code>pingfederate-admin:\ncontainer:\nwaitFor:\npingdirectory:\nservice: ldaps\npingdatagovernance:\nservice: https\n</code></pre> </li> <li> <p>By default, the <code>pingfederate-engine</code> will waitFor <code>pingfederate-admin</code> before it   starts.</p> </li> </ul>"},{"location":"release-notes/previousReleases/#release-034","title":"Release 0.3.4","text":"<ul> <li>Adding init container to PingFederate Admin to wait-for PingDirectory's LDAPs   port if the pingdirectory.enabled=true.  This fixes an issue that keeps   PingFederate Admin from starting when it's dependent on PingDirectory.  In   the case that PingFederate isn't dependent on PingDirectory and it is still   enabled, it will simply delay the start time of PingFederate admin.  A future   version will allow for specifying a list of services to wait-for so this can   be turned off/on by deployer.</li> <li>Moved the securityContext settings added to release 0.3.3 from the container   to the workload, as that is the proper place to use them.  Required for use of   <code>fsGroup</code> setting.</li> </ul>"},{"location":"release-notes/previousReleases/#release-033","title":"Release 0.3.3","text":"<ul> <li>Adding the ability for a deployer to add a securityContext to the containers.   Currently, there are warning messages in the images when an outside-in pattern is   used (i.e. securityContext is set). Also, many of the default ports require privileged   access, so care should be taken along with testing to ensure the containers start up   fine. Additional, one should not change the security context when doing and upgrade   or using a PCV from a previous deployment.</li> </ul> <p>An example securityContext that can be used might look like:</p> <pre><code>global:\ncontainer:\nsecurityContext:\nallowPrivilegeEscalation: false\ncapabilities:\ndrop:\n- ALL\nrunAsGroup: 1000\nrunAsNonRoot: true\nrunAsUser: 100\n</code></pre> <p>By default, the values.yaml in the chart will set the securityContext to empty:</p> <pre><code>global:\ncontainer:\nsecurityContext: {}\n</code></pre>"},{"location":"release-notes/previousReleases/#release-032","title":"Release 0.3.2","text":"<ul> <li>Replaced init container on pingfederate-engine to use pingtoolkit rather than 3rd party   curlimage.  Additionally added resource constraints and security context to this init   container.</li> <li>Remove hardcoded SERVER_PROFILE_BRANCH set to master, relying on git repo default branch</li> <li>Cleanup pingdelegator values.  public hostnames for pingfederate and pingdirectory   built based off of ingress hostnames, part of <code>{release-name}-global-env-vars</code> configmap.</li> <li> <p>Remove default nginx annotations of ingress resources.  If an nginx controller is used   for ingress, the following ingress annotations should be included:</p> <p>Warning</p> <p>By removing the following annotations from the default, use of current config values will result in no ingress being set.  You must add these in via your .yaml file or via separate --set settings.</p> <pre><code>global:\ningress:\nannotations:\nnginx.ingress.kubernetes.io/backend-protocol: \"HTTPS\"\nkubernetes.io/ingress.class: \"nginx-public\"\n</code></pre> </li> </ul>"},{"location":"release-notes/previousReleases/#release-031","title":"Release 0.3.1","text":"<ul> <li>Add container envFrom for <code>{release-name}-env-vars</code> back as optional.   Fixes breaking change from 0.2.8 to 0.2.9 for those that used this configmap.</li> <li>Added ability for deployer to add their own envFrom's via their values.yaml.   An example (adding an optional configmap/secrets to all products).  Just change   global to the name of the product to only have that product use the references.</li> </ul> <pre><code>global:\ncontainer:\nenvFrom:\n- configMapRef:\nname: my-killer-configmap\noptional: true\n- secretRef:\nname: my-killer-secrets\noptional: true\n</code></pre>"},{"location":"release-notes/previousReleases/#release-030","title":"Release 0.3.0","text":"<ul> <li>Consolidate deployment/stateful set templates to a single workload template.</li> <li> <p>Changes to values.yaml</p> <ul> <li>Created a workload map under global (see below)</li> <li>Moved old deployment information under workload</li> <li>Moved old statefulSet information under workload</li> <li>Updated <code>pingfederate-admin</code> to reflect new workload</li> <li>Updated <code>pingdirectory</code> to reflect new workload</li> <li>Allows for any product to be run as a deployment or statefulSet</li> </ul> <p>Warning</p> <p>Using <code>workload.type=StatefulSet</code> will create <code>pvc</code> resources and allow for persistence on restarts of containers.  This is helpful during development.  Be aware that the <code>pvc</code> resources will need to be deleted to startup a fresh copy of the product images.</p> <p>```yaml global:   workload:     type: Deployment        # Can be Deployment or StatefulSet (see warning above)</p> <pre><code>deployment:\nstrategy:\ntype: RollingUpdate # Can be RollingUpdate or Recreate\nrollingUpdate:\nmaxSurge: 1\nmaxUnavailable: 0\n\nstatefulSet:\npartition: 0          # Used for canary testing if n&gt;0\n\npersistentvolume:\nenabled: true\n############################################################\n# For every volume defined in the volumes list, 3 items will be\n# created in the StatefulSet\n#   1. container.volumeMounts - name and mountPath\n#   2. template.spec.volume - name and persistentVolumeClaim.claimName\n#   3. spec.volumeClaimTemplates - persistentVolumeClaim\n#\n# https://kubernetes.io/docs/concepts/storage/persistent-volumes/\n############################################################\nvolumes:\nout-dir:\nmountPath: /opt/out\npersistentVolumeClaim:\naccessModes:\n- ReadWriteOnce\nstorageClassName:\nresources:\nrequests:\nstorage: 4Gi\n</code></pre> <p>```</p> </li> <li> <p>Renamed template files in pinglib from .yaml to .tpl</p> </li> <li>Added <code>terminationGracePeriodSeconds</code> to container to support setting in values</li> <li>Added <code>serviceAccountName</code> to vault.hashicorp to specify to the container what service   account can be used to authenticate to the Hashicorp Vault Injector</li> </ul>"}]}